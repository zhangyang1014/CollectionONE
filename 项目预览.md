# CCO催收系统 v2.0 项目预览

## 📊 项目概览

**项目名称**：CloudunCollectionONE（CCO催收系统）  
**版本**：v2.0.0  
**架构**：前后端分离  
**技术栈**：
- 后端：FastAPI + SQLAlchemy + PostgreSQL/MySQL
- 前端：Vue 3 + TypeScript + Element Plus

---

## 📂 项目结构树

```
CloudunCollectionONE/
├── backend/                          # 后端目录
│   ├── alembic/                      # 数据库迁移
│   │   ├── env.py
│   │   └── script.py.mako
│   ├── app/
│   │   ├── __init__.py
│   │   ├── main.py                   # 主应用入口
│   │   ├── core/                     # 核心配置
│   │   │   ├── __init__.py
│   │   │   ├── cache.py              # Redis缓存
│   │   │   ├── config.py             # 配置管理
│   │   │   ├── database.py           # 数据库连接
│   │   │   └── security.py           # 安全认证
│   │   ├── models/                   # 数据库模型
│   │   │   ├── __init__.py           ✨ 已更新
│   │   │   ├── audit_log.py          # 审计日志
│   │   │   ├── case.py               ✨ 已更新（新增组织和队列字段）
│   │   │   ├── case_assignment_history.py  ✨ 新增（案件分配历史）
│   │   │   ├── case_queue.py         ✨ 新增（案件队列）
│   │   │   ├── collection_agency.py  ✨ 新增（催收机构）
│   │   │   ├── collection_team.py    ✨ 新增（催收小组）
│   │   │   ├── collector.py          ✨ 新增（催员）
│   │   │   ├── custom_field.py       # 自定义字段
│   │   │   ├── field_dependency.py   # 字段联动
│   │   │   ├── field_filter_config.py # 字段筛选
│   │   │   ├── field_group.py        # 字段分组
│   │   │   ├── queue_field_config.py ✨ 新增（队列字段配置）
│   │   │   ├── standard_field.py     # 标准字段
│   │   │   ├── tenant.py             # 甲方配置
│   │   │   └── tenant_field_config.py # 甲方字段配置
│   │   ├── schemas/                  # Pydantic Schemas
│   │   │   ├── __init__.py
│   │   │   ├── case.py               # 案件Schemas
│   │   │   ├── custom_field.py       # 自定义字段Schemas
│   │   │   ├── field_dependency.py   # 字段联动Schemas
│   │   │   ├── field_group.py        # 字段分组Schemas
│   │   │   ├── organization.py       ✨ 新增（组织架构Schemas）
│   │   │   ├── queue.py              ✨ 新增（队列管理Schemas）
│   │   │   ├── standard_field.py     # 标准字段Schemas
│   │   │   └── tenant.py             # 甲方Schemas
│   │   └── api/                      # API路由
│   │       ├── __init__.py
│   │       ├── agencies.py           ✨ 新增（催收机构API）
│   │       ├── cases.py              # 案件管理API
│   │       ├── custom_fields.py      # 自定义字段API
│   │       ├── field_dependencies.py # 字段联动API
│   │       ├── field_groups.py       # 字段分组API
│   │       ├── standard_fields.py    # 标准字段API
│   │       └── tenants.py            # 甲方管理API
│   ├── alembic.ini                   # Alembic配置
│   ├── requirements.txt              # Python依赖
│   ├── create_tables.py              # 创建表脚本
│   ├── generate_mock_data.py         # 生成测试数据
│   └── mock_server.py                # Mock服务器
├── frontend/                         # 前端目录
│   ├── src/
│   │   ├── main.ts                   # 主入口
│   │   ├── App.vue                   # 根组件
│   │   ├── api/                      # API调用
│   │   │   ├── case.ts               # 案件API
│   │   │   ├── field.ts              # 字段API
│   │   │   ├── im.ts                 # IM API
│   │   │   ├── organization.ts       ✨ 新增（组织架构API）
│   │   │   ├── queue.ts              ✨ 新增（队列管理API）
│   │   │   └── tenant.ts             # 甲方API
│   │   ├── types/                    # TypeScript类型
│   │   │   ├── index.ts              # 基础类型
│   │   │   ├── organization.ts       ✨ 新增（组织架构类型）
│   │   │   └── queue.ts              ✨ 新增（队列管理类型）
│   │   ├── components/               # 公共组件
│   │   │   ├── CaseDetail.vue        # 案件详情
│   │   │   └── IMPanel.vue           # IM面板
│   │   ├── views/                    # 页面视图
│   │   │   ├── case-management/      # 案件管理
│   │   │   │   ├── CaseDetail.vue
│   │   │   │   └── CaseList.vue
│   │   │   ├── channel-config/       # 渠道配置
│   │   │   │   └── ChannelLimitConfig.vue
│   │   │   ├── dashboard/            # 仪表盘
│   │   │   │   └── Index.vue
│   │   │   ├── field-config/         # 字段配置
│   │   │   │   ├── CustomFields.vue
│   │   │   │   ├── FieldGroups.vue
│   │   │   │   ├── FieldLinkage.vue
│   │   │   │   └── StandardFields.vue
│   │   │   ├── im/                   # IM工作台
│   │   │   │   ├── CollectorWorkspace.vue
│   │   │   │   ├── Login.vue
│   │   │   │   └── Workspace.vue
│   │   │   ├── organization/         ✨ 新增（组织管理）
│   │   │   │   └── AgencyList.vue    ✨ 新增（机构列表）
│   │   │   ├── tenant-management/    # 甲方管理
│   │   │   │   ├── TenantFieldConfig.vue
│   │   │   │   └── TenantList.vue
│   │   ├── layouts/                  # 布局组件
│   │   │   ├── ImLayout.vue
│   │   │   └── MainLayout.vue
│   │   ├── router/                   # 路由配置
│   │   │   └── index.ts
│   │   ├── stores/                   # Pinia状态管理
│   │   │   ├── field.ts
│   │   │   ├── imUser.ts
│   │   │   ├── tenant.ts
│   │   │   └── user.ts
│   │   ├── i18n/                     # 国际化
│   │   │   ├── index.ts
│   │   │   └── locales/
│   │   │       ├── en.ts
│   │   │       └── zh-CN.ts
│   │   └── utils/                    # 工具函数
│   │       └── request.ts
│   ├── index.html
│   ├── package.json
│   ├── vite.config.ts
│   ├── tsconfig.json
│   └── tsconfig.node.json
├── 参考内容/                         # 参考文档
│   ├── CCO催收字段集合-借款记录.csv
│   ├── CCO催收字段集合-分期详情.csv
│   ├── CCO催收字段集合-客户基础信息.csv
│   ├── CCO催收字段集合-贷款详情.csv
│   └── CCO催收字段集合-还款记录.csv
├── CCO字段配置系统设计.md            ✨ 已更新（v2.0设计）
├── CCO-IM端登录系统实现说明.md
├── 催员工作台实现说明.md
├── 部署指南.md
├── 项目实施说明.md
├── 实现进度说明.md                    ✨ 新增
├── 快速开始指南.md                    ✨ 新增
└── README.md
```

---

## 🎯 v2.0 核心功能模块

### 1. 组织架构管理 ✨ 新增

#### 数据库模型
- **催收机构** (`collection_agencies`)
  - 机构编码、名称、联系方式
  - 支持多机构管理
  - 统计小组数、催员数、案件数

- **催收小组** (`collection_teams`)
  - 小组编码、名称、类型
  - 关联机构和组长
  - 设置最大案件容量

- **催员** (`collectors`)
  - 催员信息、等级、擅长领域
  - 工作容量管理
  - 绩效评分

#### 前端页面
- ✅ **催收机构管理页面** (`AgencyList.vue`)
  - 列表查询（含统计）
  - 创建/编辑/删除
  - 状态管理
  - 页面导航

- ⏳ 待实现：小组管理、催员管理

### 2. 案件队列管理 ✨ 新增

#### 数据库模型
- **案件队列** (`case_queues`)
  - M1、M2、M3+、法务队列等
  - 按逾期天数划分
  - 队列状态管理

- **队列字段配置** (`queue_field_configs`)
  - 字段可见性控制
  - 必填/只读/可编辑设置
  - 字段排序

#### 功能特性
- 不同队列显示不同字段
- 配置优先级：队列 > 甲方 > 默认
- 支持从其他队列复制配置

### 3. 案件分配与流转 ✨ 新增

#### 数据库模型
- **案件分配历史** (`case_assignment_history`)
  - 记录所有分配操作
  - 完整的流转链路
  - 审计追踪

#### 分配方式
- 分配到机构
- 分配到小组
- 分配到催员
- 自动分配（均衡/随机/技能匹配）
- 案件转移
- 批量回收

### 4. 字段映射机制 ✨ 新增

#### 功能说明
- 支持甲方使用自己的字段名
- 系统自动进行映射转换
- 批量导入/导出配置

#### 使用场景
```
甲方字段：UID → 系统字段：user_id
甲方字段：UserName → 系统字段：user_name
```

### 5. 字段联动可配置化 ✨ 增强

#### 新特性
- 支持多字段联动
- 可视化配置界面
- 规则优先级管理
- 支持测试功能

#### 联动类型
- 显示/隐藏控制
- 选项变化
- 必填切换

---

## 📈 数据库变更统计

### 新增表（8个）
1. ✅ `collection_agencies` - 催收机构
2. ✅ `collection_teams` - 催收小组
3. ✅ `collectors` - 催员
4. ✅ `case_queues` - 案件队列
5. ✅ `queue_field_configs` - 队列字段配置
6. ✅ `case_assignment_history` - 案件分配历史
7. ⏳ 待更新：`tenant_field_configs` - 字段映射
8. ⏳ 待更新：`field_dependencies` - 联动规则

### 修改表（1个）
- ✅ `cases` - 新增字段：
  - `agency_id` - 所属机构
  - `team_id` - 所属小组
  - `collector_id` - 分配催员
  - `queue_id` - 所属队列
  - `overdue_days` - 逾期天数
  - `outstanding_amount` - 逾期金额
  - `assigned_at` - 分配时间
  - 等

---

## 🔧 技术实现亮点

### 后端
1. **完整的ORM关系映射**
   - 一对多、多对多关系
   - 级联删除控制
   - 外键约束

2. **Pydantic数据验证**
   - 请求数据验证
   - 响应数据序列化
   - 类型安全

3. **RESTful API设计**
   - 统一的响应格式
   - 完整的CRUD操作
   - 错误处理

### 前端
1. **TypeScript类型安全**
   - 完整的类型定义
   - 编译时类型检查
   - IDE智能提示

2. **组件化开发**
   - 可复用组件
   - 统一的UI风格
   - Element Plus组件库

3. **响应式设计**
   - Vue 3 Composition API
   - 响应式数据流
   - 高性能渲染

---

## 📊 代码统计

### 已完成代码
- **后端模型**：~800行（6个新文件 + 2个更新）
- **后端Schemas**：~500行（2个新文件）
- **后端API**：~150行（1个示例）
- **前端类型**：~300行（2个新文件）
- **前端API**：~200行（2个新文件）
- **前端页面**：~400行（1个示例）
- **文档**：~3000行（设计+指南）

**总计**：~5,350行核心代码

### 待完成代码估算
- **后端API路由**：~800行（4个文件）
- **前端页面组件**：~2000行（5个文件）
- **配置和路由**：~200行

**预计总计**：~8,350行

---

## 🎨 界面预览

### 催收机构管理页面
```
┌─────────────────────────────────────────────────────────┐
│ 催收机构管理                            [添加机构]        │
├─────────────────────────────────────────────────────────┤
│ 甲方: [选择甲方 ▼]  状态: [全部 ▼]  [查询] [重置]      │
├─────────────────────────────────────────────────────────┤
│ 机构编码 │ 机构名称 │ 联系人 │ 小组数 │ 催员数 │ 操作  │
│─────────┼─────────┼───────┼───────┼───────┼────────│
│ AG001   │ 自营中心 │ 张三   │   5   │   25   │ 详情 │
│ AG002   │ 外包A    │ 李四   │   3   │   15   │ 编辑 │
│ AG003   │ 外包B    │ 王五   │   2   │   10   │ 删除 │
└─────────────────────────────────────────────────────────┘
```

---

## 🚀 快速体验

### 1. 查看设计文档
```bash
open "CCO字段配置系统设计.md"
```

### 2. 查看实现进度
```bash
open "实现进度说明.md"
```

### 3. 开始开发
```bash
open "快速开始指南.md"
```

### 4. 查看代码示例
- 后端：`backend/app/api/agencies.py`
- 前端：`frontend/src/views/organization/AgencyList.vue`

---

## 📋 下一步计划

### 优先级1（核心功能）
- [ ] 执行数据库迁移
- [ ] 完成小组管理API和页面
- [ ] 完成催员管理API和页面

### 优先级2（队列管理）
- [ ] 完成队列管理API和页面
- [ ] 完成队列字段配置页面

### 优先级3（完善）
- [ ] 案件分配功能集成
- [ ] 催员详情页面（含图表）
- [ ] 测试和优化

---

## 📞 技术支持

如有问题，请参考：
- 📖 [设计文档](./CCO字段配置系统设计.md)
- 🚀 [快速开始](./快速开始指南.md)
- 📊 [实现进度](./实现进度说明.md)

---

**项目状态**：核心架构已完成 ✅  
**可用性**：已可进行功能开发和测试  
**最后更新**：2024-11-11

