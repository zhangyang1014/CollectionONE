# CollectionONE é¡¹ç›®å¼€å‘è§„åˆ™

## ğŸš¨ å…³é”®åŸåˆ™

### 1. åç«¯æ¶æ„è§„åˆ™

#### âŒ ç¦æ­¢ä½¿ç”¨Pythonåç«¯
- **Pythonåç«¯å·²åºŸå¼ƒ**ï¼Œä¸è¦å¯åŠ¨æˆ–ä¿®æ”¹ `backend/` ç›®å½•ä¸‹çš„ä»»ä½•ä»£ç 
- æ‰€æœ‰åç«¯åŠŸèƒ½å¿…é¡»ä½¿ç”¨ **Javaåç«¯** (`backend-java/`)
- Pythonåç«¯ä»…ä¿ç•™ç”¨äºå‚è€ƒï¼Œä¸å†è¿è¡Œ

#### âœ… ä½¿ç”¨Javaåç«¯
- **ç«¯å£**: 8080ï¼ˆå›ºå®šï¼‰
- **Javaç‰ˆæœ¬**: å¿…é¡»ä½¿ç”¨ **Java 17**ï¼ˆä¸èƒ½ä½¿ç”¨Java 25ï¼‰
- **å¯åŠ¨æ–¹å¼**: 
  ```bash
  JAVA_HOME=/opt/homebrew/opt/openjdk@17 \
  PATH=/opt/homebrew/opt/openjdk@17/bin:$PATH \
  mvn spring-boot:run -Dspring-boot.run.profiles=dev
  ```
- **æˆ–ä½¿ç”¨å¯åŠ¨è„šæœ¬**: `./backend-java/start.sh`

---

### 2. å‰ç«¯APIè°ƒç”¨è§„åˆ™

#### âŒ ä¸¥ç¦ç¡¬ç¼–ç ç«¯å£
**é”™è¯¯ç¤ºä¾‹**:
```typescript
// âŒ ç»å¯¹ä¸è¦è¿™æ ·å†™ï¼
const url = `http://localhost:8000/api/v1/cases`
const url = `http://localhost:8080/api/v1/cases`
```

#### âœ… æ­£ç¡®åšæ³•
```typescript
// âœ… æ–¹æ³•1: ä½¿ç”¨ç»Ÿä¸€çš„APIé…ç½®
import { getApiUrl, API_BASE_URL } from '@/config/api'
const url = getApiUrl('cases')

// âœ… æ–¹æ³•2: ä½¿ç”¨requestå·¥å…·ï¼ˆæ¨èï¼‰
import request from '@/utils/request'
const data = await request({ url: '/cases', method: 'get' })

// âœ… æ–¹æ³•3: å¦‚æœå¿…é¡»ç”¨fetchï¼Œä½¿ç”¨API_BASE_URL
import { API_BASE_URL } from '@/config/api'
const url = `${API_BASE_URL}/api/v1/cases`
```

#### ğŸ” ä»£ç å®¡æŸ¥æ£€æŸ¥ç‚¹
- æœç´¢ `localhost:8000` - åº”è¯¥ä¸º 0 ç»“æœ
- æœç´¢ `localhost:8080` - åº”è¯¥åªåœ¨ `config/api.ts` ä¸­å‡ºç°
- æ‰€æœ‰APIè°ƒç”¨å¿…é¡»ä½¿ç”¨é…ç½®æ–‡ä»¶æˆ–requestå·¥å…·

---

### 3. TypeScript/JavaScriptè¯­æ³•è§„åˆ™

#### âŒ importè¯­å¥ä½ç½®é”™è¯¯
```typescript
// âŒ é”™è¯¯ï¼šimportä¸èƒ½åœ¨å‡½æ•°å†…éƒ¨
function myFunction() {
  import { something } from 'somewhere'  // ä¼šæŠ¥é”™ï¼
}

try {
  import { something } from 'somewhere'  // ä¼šæŠ¥é”™ï¼
} catch (e) {}
```

#### âœ… æ­£ç¡®çš„importä½ç½®
```typescript
// âœ… importå¿…é¡»åœ¨æ–‡ä»¶é¡¶éƒ¨
import { something } from 'somewhere'
import { another } from 'another-place'

// ç„¶åæ‰æ˜¯å‡½æ•°å®šä¹‰
function myFunction() {
  // ä½¿ç”¨å¯¼å…¥çš„å†…å®¹
  something()
}
```

---

### 4. Javaåç«¯å¼€å‘è§„åˆ™

#### Mavenç¼–è¯‘è§„åˆ™
- **Javaç‰ˆæœ¬**: å¿…é¡»ä½¿ç”¨Java 17
- **ç¼–è¯‘å™¨æ’ä»¶**: maven-compiler-plugin 3.11.0
- **ä¸è¦ä½¿ç”¨**: Java 25ï¼ˆä¸Mavenæ’ä»¶ä¸å…¼å®¹ï¼‰

#### ä¾èµ–ç®¡ç†
- **Swagger/OpenAPI**: ä½¿ç”¨ `springdoc-openapi-starter-webmvc-ui:2.2.0`
- **MyBatis-Plus**: 3.5.8
- **Spring Boot**: 3.3.5

#### ä»£ç ç»„ç»‡
- Mockæ§åˆ¶å™¨å‘½å: `Mock*Controller.java`
- å“åº”æ ¼å¼: ä½¿ç”¨ `com.cco.common.result.Result` æˆ– `com.cco.common.response.ResponseData`
- ç¦ç”¨æ•°æ®åº“æ—¶: ä¸è¦æ³¨å…¥Mapperï¼Œä½¿ç”¨Mockå®ç°

---

### 5. Gitç®¡ç†è§„åˆ™

#### ä¸è¦æäº¤çš„æ–‡ä»¶
- `*.bak` - å¤‡ä»½æ–‡ä»¶åº”è¯¥åˆ é™¤ï¼Œä¸è¦ä¿ç•™
- `*.log` - æ—¥å¿—æ–‡ä»¶
- `target/` - Javaç¼–è¯‘è¾“å‡º
- `node_modules/` - å‰ç«¯ä¾èµ–
- `.env` - ç¯å¢ƒå˜é‡æ–‡ä»¶

#### é‡è¦æ–‡ä»¶ä¿æŠ¤
- âœ… **å¿…é¡»ä¿ç•™**: `backend-java/` - Javaåç«¯æºç 
- âœ… **å¿…é¡»ä¿ç•™**: `frontend/` - å‰ç«¯æºç 
- âš ï¸ **ä»…ä¾›å‚è€ƒ**: `backend/` - Pythonåç«¯ï¼ˆå·²åºŸå¼ƒï¼‰

---

### 6. å“åº”æ•°æ®æ ¼å¼è§„åˆ™

#### Pythonåç«¯æ ¼å¼ï¼ˆå·²åºŸå¼ƒï¼‰
```json
{
  "data": [...]  // ç›´æ¥è¿”å›æ•°ç»„
}
```

#### Javaåç«¯æ ¼å¼ï¼ˆå½“å‰ä½¿ç”¨ï¼‰
```json
{
  "code": 200,
  "message": "success",
  "data": [...]
}
```

#### å‰ç«¯å¤„ç†
```typescript
// âœ… å…¼å®¹ä¸¤ç§æ ¼å¼
const result = await response.json()
const data = Array.isArray(result) ? result : (result.data || [])
```

---

### 7. ç«¯å£åˆ†é…è§„åˆ™

| æœåŠ¡ | ç«¯å£ | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|------|
| å‰ç«¯ (Vite) | 5173 | âœ… ä½¿ç”¨ä¸­ | Vue3å¼€å‘æœåŠ¡å™¨ |
| Javaåç«¯ | 8080 | âœ… ä½¿ç”¨ä¸­ | Spring Boot |
| Pythonåç«¯ | 8000 | âŒ å·²åºŸå¼ƒ | ä¸å†ä½¿ç”¨ |

#### æ£€æŸ¥ç«¯å£å ç”¨
```bash
# æ£€æŸ¥8080æ˜¯å¦è¢«å ç”¨
lsof -i :8080

# å¦‚æœéœ€è¦åœæ­¢è¿›ç¨‹
kill <PID>
```

---

### 8. ç¯å¢ƒå˜é‡è§„åˆ™

#### å‰ç«¯ç¯å¢ƒå˜é‡
```bash
# .env.development
VITE_API_BASE_URL=http://localhost:8080

# .env.production
VITE_API_BASE_URL=http://your-production-domain.com
```

#### ä½¿ç”¨æ–¹å¼
```typescript
// âœ… ä½¿ç”¨ç¯å¢ƒå˜é‡
const baseURL = import.meta.env.VITE_API_BASE_URL || 'http://localhost:8080'

// âŒ ä¸è¦ç¡¬ç¼–ç 
const baseURL = 'http://localhost:8080'
```

---

### 9. ä»£ç ä¿®æ”¹æ£€æŸ¥æ¸…å•

#### æ¯æ¬¡ä¿®æ”¹å‰ç«¯APIè°ƒç”¨æ—¶
- [ ] æ˜¯å¦ä½¿ç”¨äº† `@/config/api` æˆ– `@/utils/request`ï¼Ÿ
- [ ] æ˜¯å¦é¿å…äº†ç¡¬ç¼–ç URLï¼Ÿ
- [ ] æ˜¯å¦è€ƒè™‘äº†å“åº”æ ¼å¼å…¼å®¹æ€§ï¼Ÿ

#### æ¯æ¬¡ä¿®æ”¹Javaåç«¯æ—¶
- [ ] æ˜¯å¦ä½¿ç”¨Java 17ç¼–è¯‘ï¼Ÿ
- [ ] æ˜¯å¦é¿å…äº†æ•°æ®åº“ä¾èµ–ï¼ˆå½“å‰Mockæ¨¡å¼ï¼‰ï¼Ÿ
- [ ] æ˜¯å¦ä½¿ç”¨äº†æ­£ç¡®çš„å“åº”æ ¼å¼ï¼ˆResultæˆ–ResponseDataï¼‰ï¼Ÿ

#### æ¯æ¬¡æäº¤ä»£ç å‰
- [ ] æ˜¯å¦åˆ é™¤äº†æ‰€æœ‰ `.bak` æ–‡ä»¶ï¼Ÿ
- [ ] æ˜¯å¦æ²¡æœ‰ç¡¬ç¼–ç çš„ `localhost:8000`ï¼Ÿ
- [ ] æ˜¯å¦ç¼–è¯‘é€šè¿‡ï¼Ÿ
- [ ] æ˜¯å¦æµ‹è¯•è¿‡åŠŸèƒ½æ­£å¸¸ï¼Ÿ

---

### 10. å¸¸è§é”™è¯¯åŠè§£å†³æ–¹æ¡ˆ

#### é”™è¯¯1: 404 Not Found
**åŸå› **: è°ƒç”¨äº†8000ç«¯å£ï¼ˆPythonåç«¯å·²åœæ­¢ï¼‰
**è§£å†³**: 
```bash
# æ£€æŸ¥ä»£ç ä¸­æ˜¯å¦æœ‰8000ç¡¬ç¼–ç 
grep -r "localhost:8000" frontend/src
# åº”è¯¥è¿”å›0ä¸ªç»“æœ
```

#### é”™è¯¯2: JWT Tokenè¿‡æœŸ
**åŸå› **: Tokenè¶…è¿‡æœ‰æ•ˆæœŸ
**è§£å†³**: 
1. æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·ï¼ˆF12ï¼‰
2. Application â†’ Local Storage
3. åˆ é™¤ `token`
4. é‡æ–°ç™»å½•

#### é”™è¯¯3: Javaç¼–è¯‘å¤±è´¥
**åŸå› **: ä½¿ç”¨äº†é”™è¯¯çš„Javaç‰ˆæœ¬
**è§£å†³**:
```bash
# æ£€æŸ¥å½“å‰Javaç‰ˆæœ¬
java -version
# åº”è¯¥æ˜¾ç¤º: openjdk version "17.0.17"

# å¦‚æœä¸æ˜¯ï¼Œè®¾ç½®æ­£ç¡®çš„Javaç‰ˆæœ¬
export JAVA_HOME=/opt/homebrew/opt/openjdk@17
export PATH=$JAVA_HOME/bin:$PATH
```

#### é”™è¯¯4: importè¯­å¥é”™è¯¯
**åŸå› **: importåœ¨tryå—æˆ–å‡½æ•°å†…éƒ¨
**è§£å†³**: å°†æ‰€æœ‰importç§»åˆ°æ–‡ä»¶é¡¶éƒ¨

---

### 11. é¡¹ç›®ç»“æ„çº¦å®š

```
CollectionONE/
â”œâ”€â”€ backend/                    # âŒ Pythonåç«¯ï¼ˆå·²åºŸå¼ƒï¼Œä»…ä¾›å‚è€ƒï¼‰
â”œâ”€â”€ backend-java/               # âœ… Javaåç«¯ï¼ˆå½“å‰ä½¿ç”¨ï¼‰
â”‚   â”œâ”€â”€ start.sh               # å¯åŠ¨è„šæœ¬
â”‚   â””â”€â”€ src/main/java/com/cco/
â”‚       â”œâ”€â”€ controller/        # Mockæ§åˆ¶å™¨
â”‚       â”œâ”€â”€ service/           # ä¸šåŠ¡æœåŠ¡
â”‚       â””â”€â”€ common/            # é€šç”¨ç»„ä»¶
â”œâ”€â”€ frontend/                   # âœ… Vue3å‰ç«¯
â”‚   â””â”€â”€ src/
â”‚       â”œâ”€â”€ config/
â”‚       â”‚   â””â”€â”€ api.ts         # âœ… APIé…ç½®ï¼ˆå¿…é¡»ä½¿ç”¨ï¼‰
â”‚       â”œâ”€â”€ utils/
â”‚       â”‚   â””â”€â”€ request.ts     # âœ… è¯·æ±‚å·¥å…·ï¼ˆæ¨èä½¿ç”¨ï¼‰
â”‚       â””â”€â”€ views/             # é¡µé¢ç»„ä»¶
â””â”€â”€ è¯´æ˜æ–‡æ¡£/                  # é¡¹ç›®æ–‡æ¡£
```

---

### 12. ä»£ç å®¡æŸ¥è‡ªåŠ¨åŒ–

#### ä½¿ç”¨grepæ£€æŸ¥è¿è§„
```bash
# æ£€æŸ¥ç¡¬ç¼–ç çš„8000ç«¯å£
grep -r "localhost:8000" frontend/src --include="*.ts" --include="*.vue"
# å¿…é¡»è¿”å›0ä¸ªç»“æœ

# æ£€æŸ¥ç¡¬ç¼–ç çš„8080ç«¯å£ï¼ˆé™¤äº†config/api.tsï¼‰
grep -r "localhost:8080" frontend/src --include="*.ts" --include="*.vue" | grep -v "config/api.ts"
# åº”è¯¥åªåœ¨å¿…è¦çš„åœ°æ–¹å‡ºç°

# æ£€æŸ¥.bakæ–‡ä»¶
find . -name "*.bak"
# åº”è¯¥è¿”å›0ä¸ªç»“æœ
```

---

### 13. ç´§æ€¥å›æ»šæŒ‡å—

å¦‚æœä¿®æ”¹å¯¼è‡´é—®é¢˜ï¼Œå¿«é€Ÿå›æ»šï¼š

```bash
# 1. åœæ­¢æ‰€æœ‰æœåŠ¡
lsof -ti :8080 | xargs kill

# 2. æ¢å¤Gitåˆ°ä¸Šä¸€ä¸ªå·¥ä½œç‰ˆæœ¬
git stash
git checkout <last-working-commit>

# 3. é‡æ–°å¯åŠ¨Javaåç«¯
cd backend-java && ./start.sh

# 4. é‡æ–°å¯åŠ¨å‰ç«¯
cd frontend && npm run dev
```

---

### 14. å›¢é˜Ÿåä½œè§„åˆ™

#### Pull Requestæ£€æŸ¥é¡¹
- [ ] ä»£ç ä¸­æ— ç¡¬ç¼–ç URL
- [ ] æ— .bakå¤‡ä»½æ–‡ä»¶
- [ ] Javaä»£ç ä½¿ç”¨Java 17ç¼–è¯‘
- [ ] importè¯­å¥åœ¨æ–‡ä»¶é¡¶éƒ¨
- [ ] å“åº”æ ¼å¼å¤„ç†å…¼å®¹Javaåç«¯
- [ ] æœ‰ç›¸åº”çš„è¯´æ˜æ–‡æ¡£æ›´æ–°

#### Code Reviewé‡ç‚¹
1. APIè°ƒç”¨æ–¹å¼æ˜¯å¦è§„èŒƒ
2. æ˜¯å¦è¯¯ç”¨äº†Pythonåç«¯
3. é”™è¯¯å¤„ç†æ˜¯å¦å®Œå–„
4. æ˜¯å¦æœ‰ç¡¬ç¼–ç é…ç½®

---

## ğŸ¯ è®°ä½è¿™äº›æ ¸å¿ƒåŸåˆ™

1. **Never hardcode URLs** - æ°¸è¿œä½¿ç”¨é…ç½®æ–‡ä»¶
2. **Java 17 only** - åªç”¨Java 17ï¼Œä¸ç”¨å…¶ä»–ç‰ˆæœ¬
3. **Port 8080 for backend** - åç«¯å›ºå®š8080ç«¯å£
4. **No Python backend** - ä¸è¦ä½¿ç”¨Pythonåç«¯
5. **imports at top** - importæ°¸è¿œåœ¨æ–‡ä»¶é¡¶éƒ¨
6. **No .bak files** - ä¸è¦ä¿ç•™å¤‡ä»½æ–‡ä»¶
7. **Mock mode** - å½“å‰ä½¿ç”¨Mockæ•°æ®ï¼Œä¸è¿æ¥æ•°æ®åº“

---

## ğŸ“š å‚è€ƒæ–‡æ¡£

- [404é”™è¯¯å®Œå…¨è§£å†³æ–¹æ¡ˆ](âœ…-404é”™è¯¯å®Œå…¨è§£å†³.md)
- [åç«¯åŒç³»ç»Ÿæ¶æ„è¯´æ˜](æ–‡æ¡£/åç«¯åŒç³»ç»Ÿæ¶æ„è¯´æ˜.md)
- [æ°¸ä¹…ä¿®å¤404é”™è¯¯å®Œæ•´æ–¹æ¡ˆ](è¯´æ˜æ–‡æ¡£/åç«¯/æ°¸ä¹…ä¿®å¤404é”™è¯¯-å®Œæ•´æ–¹æ¡ˆ.md)
- [å¿«é€Ÿå¯åŠ¨Javaåç«¯](å¿«é€Ÿå¯åŠ¨Javaåç«¯.md)

---

**æœ€åæ›´æ–°**: 2025-11-22  
**ç‰ˆæœ¬**: 1.0.0


