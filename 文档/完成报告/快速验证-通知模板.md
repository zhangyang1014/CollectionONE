# 通知模板功能 - 快速验证指南

## 🎯 验证目标
确认通知模板功能已正常运行,可以看到10条测试数据。

## ✅ 验证步骤

### 步骤1: 确认后端服务运行
```bash
# 检查后端进程
ps aux | grep uvicorn

# 如果没有运行,启动后端
cd /Users/zhangyang/Documents/GitHub/CollectionONE/backend
bash restart_backend.sh
```

### 步骤2: 测试API
```bash
# 测试模板列表API
curl http://localhost:8000/api/v1/notification-templates

# 测试模板类型API
curl http://localhost:8000/api/v1/notification-templates/types/list
```

**预期结果**: 
- 第一个命令应返回10条模板记录
- 第二个命令应返回6种模板类型

### 步骤3: 访问前端页面
1. 打开浏览器
2. 访问: http://localhost:5173/admin/login
3. 登录系统 (使用 SuperAdmin 账号)
4. 进入: **系统设置 → 通知配置**
5. 点击 **"通知模板"** 标签页

**预期结果**:
- ✅ 看到10条模板记录
- ✅ 表格显示完整 (模板名称、ID、类型、发送对象、优先级等)
- ✅ 无控制台错误
- ✅ 无 Element Plus 警告

### 步骤4: 测试功能
1. **查看模板详情**: 点击任意模板的 "编辑" 按钮
2. **切换启用状态**: 点击表格中的开关
3. **添加新模板**: 点击 "添加通知模板" 按钮
4. **删除模板**: 点击 "删除" 按钮

**预期结果**: 所有操作正常,无错误提示

## 📊 10条测试数据清单

| # | 模板名称 | 模板ID | 租户 | 发送对象 |
|---|---------|--------|------|---------|
| 1 | 案件标签变化通知 | TPL_CASE_TAG_CHANGE | tenant_a | 机构 |
| 2 | 案件还款通知 | TPL_CASE_REPAYMENT | tenant_a | 小组 |
| 3 | 客户访问APP通知 | TPL_USER_ACCESS_APP | tenant_a | 催员 |
| 4 | 客户访问还款页通知 | TPL_USER_ACCESS_REPAY_PAGE | tenant_a | 催员 |
| 5 | 案件分配通知 | TPL_CASE_ASSIGNED | tenant_a | 催员 |
| 6 | 案件逾期提醒 | TPL_OVERDUE_REMINDER | tenant_b | 机构 |
| 7 | 承诺还款提醒 | TPL_PROMISE_REMINDER | tenant_b | 催员 |
| 8 | 系统维护通知 | TPL_SYSTEM_MAINTENANCE | tenant_a | 机构 |
| 9 | 催收目标达成通知 | TPL_TARGET_ACHIEVED | tenant_a | 催员 |
| 10 | 客户投诉通知 | TPL_CUSTOMER_COMPLAINT | tenant_b | 小组 |

## 🔍 常见问题

### Q1: 前端显示空白或404错误
**A**: 检查后端服务是否正常运行
```bash
curl http://localhost:8000/api/v1/notification-templates
```

### Q2: 看不到10条数据
**A**: 重新运行数据库初始化脚本
```bash
cd /Users/zhangyang/Documents/GitHub/CollectionONE/backend
source venv/bin/activate
python3 setup_notification_templates.py
```

### Q3: 控制台报类型错误
**A**: 清除浏览器缓存并刷新页面 (Cmd+Shift+R)

### Q4: API返回500错误
**A**: 检查后端日志,可能是数据类型不匹配
```bash
# 查看后端日志
tail -f /Users/zhangyang/Documents/GitHub/CollectionONE/backend/logs/*.log
```

## ✅ 验证成功标志

- [x] 后端API返回10条记录
- [x] 前端表格显示10行数据
- [x] 可以编辑任意模板
- [x] 可以切换启用状态
- [x] 可以添加新模板
- [x] 可以删除模板
- [x] 无控制台错误
- [x] 无 Element Plus 警告

## 🎉 完成!

如果以上验证都通过,说明通知模板功能已完全正常运行!

