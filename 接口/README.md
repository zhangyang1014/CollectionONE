# CCO 系统接口文档

## 📋 概述

本目录包含CCO催收系统的完整API接口文档，涵盖三个不同的接口体系，共150+个接口。

---

## 📚 文档导航

### [0-接口文档总览](./0-接口文档总览.md) 🌟 推荐从这里开始

**内容**:
- 三个接口文档的完整索引
- 接口关系图和数据流转说明
- 快速开始指南
- 通用规范说明

---

### [1-管理控台API文档](./1-管理控台API文档.md)

**适用对象**: SuperAdmin、TenantAdmin、AgencyAdmin

**Base URL**: `http://localhost:8000/api/v1`

**接口模块** (13个模块，80+接口):
- 🔐 认证授权
- 🏢 甲方管理
- 🏛️ 机构管理
- 👥 小组群管理
- 🎯 小组管理
- 👤 催员管理
- 📋 案件队列管理
- 📦 案件管理
- 🎨 字段管理
- 🔔 通知系统
- 📊 数据看板
- 📈 报表导出
- ⚙️ 系统配置

**主要功能**:
- 系统管理和配置
- 组织架构管理
- 案件导入和分配
- 字段配置
- 数据统计和分析

---

### [2-甲方应提供的接口文档](./2-甲方应提供的接口文档.md)

**适用对象**: 甲方技术团队、第三方集成商

**接口类型** (4类，14个接口):

#### 📤 推送接口（甲方→CCO）
- 批量推送逾期案件
- 案件状态更新推送
- 还款记录推送

#### 📥 查询接口（CCO→甲方）
- 查询客户详细信息
- 查询贷款详情
- 查询还款记录
- 批量查询案件状态

#### 📝 回写接口（CCO→甲方）
- 回写沟通记录
- 回写PTP承诺
- 回写催收结果
- 回写案件状态变更

#### 🔔 通知接口（甲方→CCO Webhook）
- 还款成功通知
- 案件结清通知
- 案件召回通知

**接口优先级**:
- **P0（必须）**: 6个核心接口
- **P1（建议）**: 5个增强接口
- **P2（可选）**: 3个扩展接口

---

### [3-IM端催员APP接口文档](./3-IM端催员APP接口文档.md)

**适用对象**: 催员、组长、前端开发团队

**Base URL**: `http://localhost:8000/api/v1/im`

**接口模块** (12个模块，60+接口):
- 🔐 认证模块
- 📱 工作台首页
- 📋 案件管理
- 📞 沟通管理
- 🤝 PTP管理
- 💰 还款管理
- 🔔 通知消息
- 📊 统计报表
- 👤 个人中心
- 📚 知识库
- 🛠️ 工具功能
- 🔧 系统功能

**主要特性**:
- ✅ 离线支持
- ✅ 实时推送（WebSocket）
- ✅ 数据脱敏
- ✅ 设备管理
- ✅ 人脸识别登录

---

## 🔄 接口关系

```
                CCO催收系统
                    │
        ┌───────────┼───────────┐
        │           │           │
  管理控台API    IM端API    甲方接口
    (Admin)    (Collector)  (Partner)
        │           │           │
        └───────────┴───────────┘
                    │
              数据库(MySQL)
```

---

## 🚀 快速开始

### 1. 管理员使用

```bash
# 登录
curl -X POST http://localhost:8000/api/v1/admin/auth/login \
  -H "Content-Type: application/json" \
  -d '{
    "loginId": "superadmin",
    "password": "123456"
  }'

# 保存token
export TOKEN="返回的token"

# 调用其他接口
curl http://localhost:8000/api/v1/tenants \
  -H "Authorization: Bearer $TOKEN"
```

### 2. 催员使用

```bash
# 登录
curl -X POST http://localhost:8000/api/v1/im/auth/login \
  -H "Content-Type: application/json" \
  -d '{
    "loginId": "collector001",
    "password": "123456"
  }'

# 查看我的案件
curl http://localhost:8000/api/v1/im/cases/my \
  -H "Authorization: Bearer $TOKEN"
```

### 3. 甲方对接

参考`2-甲方应提供的接口文档.md`中的对接流程：
1. 获取API认证信息
2. 实现P0核心接口
3. 联调测试
4. 生产上线

---

## 📋 接口规范

### 通用响应格式

**成功**:
```json
{
  "code": 200,
  "message": "success",
  "data": { ... }
}
```

**失败**:
```json
{
  "code": 400,
  "message": "参数错误",
  "data": null
}
```

### 状态码

| Code | 说明 |
|------|------|
| 200 | 成功 |
| 400 | 请求参数错误 |
| 401 | 未授权 |
| 403 | 禁止访问 |
| 404 | 资源不存在 |
| 500 | 服务器错误 |

### 认证方式

**管理控台和IM端**: JWT Token
```
Authorization: Bearer {token}
```

**甲方接口**: API Key + HMAC签名
```
X-Api-Key: {api_key}
X-Api-Secret: {api_secret}
X-Timestamp: {timestamp}
X-Signature: {signature}
```

---

## 📊 接口统计

| 接口类型 | 模块数 | 接口数 | 说明 |
|---------|-------|--------|------|
| 管理控台API | 13 | 80+ | 系统管理和配置 |
| 甲方接口 | 7 | 14 | 甲方对接规范 |
| IM端API | 12 | 60+ | 催员移动端 |
| **总计** | **32** | **150+** | 完整覆盖 |

---

## 🔐 安全说明

### 敏感信息保护

1. **传输加密**: 生产环境必须使用HTTPS
2. **数据脱敏**: 
   - 手机号: `+63-917-***-**11`
   - 身份证号: `ID***456`
   - 银行卡号: `****1234`
3. **IP白名单**: 限制访问来源
4. **请求频率限制**: 防止恶意调用

### Token管理

- Access Token有效期: 24小时
- Refresh Token有效期: 7天
- 支持Token刷新机制

---

## 📖 相关文档

- [测试用例](../测试/完整功能测试用例.md) - 完整的接口测试用例
- [项目README](../README.md) - 项目总体介绍
- [数据库设计](../backend-java/src/main/resources/db/migration/schema.sql) - 数据库结构

---

## 🔧 开发工具

### Postman Collection

TODO: 导出Postman Collection供开发者使用

### API文档生成

TODO: 使用Swagger/OpenAPI生成交互式文档

### Mock Server

TODO: 提供Mock Server用于前端开发

---

## 📝 版本历史

### v1.0.0 (2025-11-20)
- ✅ 完成管理控台API（80+接口）
- ✅ 完成甲方接口规范（14个接口）
- ✅ 完成IM端API（60+接口）

---

## 💡 使用建议

### 1. 首次使用

1. 先阅读`0-接口文档总览.md`了解整体架构
2. 根据角色选择对应的接口文档
3. 参考快速开始指南进行测试

### 2. 开发者

- **后端开发**: 参考接口文档实现API
- **前端开发**: 根据接口文档调用API
- **测试人员**: 使用测试用例进行测试

### 3. 甲方技术团队

1. 阅读`2-甲方应提供的接口文档.md`
2. 优先实现P0核心接口
3. 按照对接流程进行联调

### 4. 产品经理

- 通过接口文档了解系统功能
- 规划产品功能和迭代
- 与技术团队对齐需求

---

## 📞 技术支持

### 文档问题

如发现文档问题（错误、遗漏、不清晰等），请：
1. 提交Issue到项目仓库
2. 发送邮件到 tech@cco.example.com
3. 联系技术对接负责人

### 技术对接

- **联系方式**: tech@cco.example.com
- **工作时间**: 工作日 9:00-18:00
- **紧急支持**: 7x24小时（生产环境）

---

## ⚠️ 重要提示

### 对于管理员

- 管理员拥有系统最高权限，请妥善保管账号密码
- 定期检查系统配置和权限设置
- 重要操作建议先在测试环境验证

### 对于催员

- 只能访问分配给自己的案件
- 注意保护客户隐私信息
- 工作状态要及时更新

### 对于甲方技术团队

- 接口必须实现认证和签名验证
- 敏感数据必须加密传输
- 配置IP白名单限制访问
- 做好接口监控和日志记录

---

**文档维护**: CCO技术团队  
**最后更新**: 2025-11-20  
**文档版本**: v1.0.0

