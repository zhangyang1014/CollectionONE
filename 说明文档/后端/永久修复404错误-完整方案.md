# æ°¸ä¹…ä¿®å¤404é”™è¯¯ - å®Œæ•´æ–¹æ¡ˆ

**åˆ›å»ºæ—¥æœŸ**: 2025-11-22  
**çŠ¶æ€**: âœ… æ–¹æ¡ˆå·²å®Œæˆ

---

## ğŸ“‹ é—®é¢˜æ¦‚è¿°

å‰ç«¯è°ƒç”¨ä»¥ä¸‹APIæ—¶å‡ºç°404é”™è¯¯ï¼š
- `/api/v1/field-display-configs` - å­—æ®µå±•ç¤ºé…ç½®
- `/api/v1/cases` - æ¡ˆä»¶åˆ—è¡¨

**æ ¹æœ¬åŸå› **: Pythonåç«¯å·²ç»åºŸå¼ƒä¸ç”¨ï¼Œä½†å‰ç«¯ä»ç„¶é…ç½®ä¸ºè°ƒç”¨8000ç«¯å£ï¼ˆPythonåç«¯ï¼‰

---

## âœ… å·²å®Œæˆçš„å·¥ä½œ

### 1. å‰ç«¯é…ç½®ä¿®æ”¹

å·²å°†å‰ç«¯APIåŸºç¡€URLä»8000ç«¯å£æ”¹ä¸º8080ç«¯å£ï¼š

**æ–‡ä»¶**: `frontend/src/utils/request.ts`

```typescript
const service: AxiosInstance = axios.create({
  baseURL: import.meta.env.VITE_API_BASE_URL || 'http://localhost:8080', // ä»8000æ”¹ä¸º8080
  timeout: 15000,
  headers: {
    'Content-Type': 'application/json',
  },
})
```

### 2. Javaåç«¯ç¼–è¯‘ä¿®å¤

- âœ… åˆ é™¤äº†æ‰€æœ‰`.bak`å¤‡ä»½æ–‡ä»¶
- âœ… æ·»åŠ äº†Swagger/OpenAPIä¾èµ–ï¼ˆspringdoc-openapi-starter-webmvc-uiï¼‰
- âœ… åˆ›å»ºäº†ç¼ºå¤±çš„Resultç±»å’ŒServiceæ¥å£
- âœ… ä¿®å¤äº†Javaç‰ˆæœ¬å…¼å®¹æ€§é—®é¢˜ï¼ˆä½¿ç”¨Java 17ï¼‰
- âœ… ç¼–è¯‘æˆåŠŸ

### 3. Javaåç«¯Mockæ§åˆ¶å™¨

å·²åˆ›å»ºä»¥ä¸‹Mockæ§åˆ¶å™¨ï¼š
- `MockFieldDisplayConfigController` - å­—æ®µå±•ç¤ºé…ç½®Mockæ•°æ®
- `MockCaseController` - æ¡ˆä»¶åˆ—è¡¨Mockæ•°æ®
- `MockTenantController` - ç”²æ–¹æ•°æ®Mockæ•°æ®

---

## ğŸš€ å¿«é€Ÿå¯åŠ¨æŒ‡å—

### æ–¹æ¡ˆAï¼šä½¿ç”¨Javaåç«¯ï¼ˆæ¨èï¼‰

#### æ­¥éª¤1: å¯åŠ¨Javaåç«¯

```bash
cd /Users/zhangyang/Documents/GitHub/CollectionONE/backend-java

# ä½¿ç”¨Java 17å¯åŠ¨
JAVA_HOME=/opt/homebrew/opt/openjdk@17 \
PATH=/opt/homebrew/opt/openjdk@17/bin:$PATH \
mvn spring-boot:run -Dspring-boot.run.profiles=dev
```

æˆ–ä½¿ç”¨å¯åŠ¨è„šæœ¬ï¼š

```bash
cd /Users/zhangyang/Documents/GitHub/CollectionONE/backend-java
./start.sh
```

#### æ­¥éª¤2: éªŒè¯Javaåç«¯å¯åŠ¨æˆåŠŸ

```bash
# æ£€æŸ¥ç«¯å£
lsof -i :8080

# æµ‹è¯•API
curl http://localhost:8080/api/v1/cases?tenantId=1
curl "http://localhost:8080/api/v1/field-display-configs?tenantId=1&sceneType=collector_case_list"
```

#### æ­¥éª¤3: å‰ç«¯è‡ªåŠ¨è¿æ¥Javaåç«¯

å‰ç«¯å·²ç»é…ç½®ä¸ºé»˜è®¤è¿æ¥8080ç«¯å£ï¼Œæ— éœ€é¢å¤–é…ç½®ã€‚

---

## ğŸ”§ å¸¸è§é—®é¢˜è§£å†³

### é—®é¢˜1: Javaç¼–è¯‘é”™è¯¯

**ç—‡çŠ¶**: `java.lang.ExceptionInInitializerError: com.sun.tools.javac.code.TypeTag :: UNKNOWN`

**åŸå› **: Java 25ä¸Mavenç¼–è¯‘å™¨æ’ä»¶ä¸å…¼å®¹

**è§£å†³æ–¹æ¡ˆ**:
```bash
# ä½¿ç”¨Java 17
export JAVA_HOME=/opt/homebrew/opt/openjdk@17
export PATH=$JAVA_HOME/bin:$PATH
```

### é—®é¢˜2: ç¼ºå°‘Mapper bean

**ç—‡çŠ¶**: `No qualifying bean of type 'com.cco.mapper.StandardFieldMapper'`

**åŸå› **: åº”ç”¨ç¦ç”¨äº†æ•°æ®åº“ä½†Serviceè¯•å›¾æ³¨å…¥Mapper

**è§£å†³æ–¹æ¡ˆ**: ä½¿ç”¨Mockæ§åˆ¶å™¨ï¼ˆå·²å®ç°ï¼‰ï¼Œä¸ä¾èµ–æ•°æ®åº“

### é—®é¢˜3: ç«¯å£è¢«å ç”¨

**ç—‡çŠ¶**: `Address already in use`

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æŸ¥æ‰¾å ç”¨ç«¯å£çš„è¿›ç¨‹
lsof -i :8080

# åœæ­¢è¿›ç¨‹
kill <PID>
```

---

## ğŸ“ é¡¹ç›®ç»“æ„è¯´æ˜

```
CollectionONE/
â”œâ”€â”€ backend/                  # Pythonåç«¯ï¼ˆå·²åºŸå¼ƒï¼‰âŒ
â”‚   â””â”€â”€ ...
â”œâ”€â”€ backend-java/             # Javaåç«¯ï¼ˆå½“å‰ä½¿ç”¨ï¼‰âœ…
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â””â”€â”€ main/java/com/cco/
â”‚   â”‚       â”œâ”€â”€ controller/
â”‚   â”‚       â”‚   â”œâ”€â”€ MockCaseController.java
â”‚   â”‚       â”‚   â”œâ”€â”€ MockFieldDisplayConfigController.java
â”‚   â”‚       â”‚   â””â”€â”€ MockTenantController.java
â”‚   â”‚       â””â”€â”€ CcoApplication.java
â”‚   â”œâ”€â”€ start.sh              # å¯åŠ¨è„šæœ¬
â”‚   â””â”€â”€ pom.xml
â””â”€â”€ frontend/                 # å‰ç«¯
    â””â”€â”€ src/utils/request.ts  # APIé…ç½®ï¼ˆå·²æ”¹ä¸º8080ï¼‰
```

---

## ğŸ¯ æ°¸ä¹…è§£å†³æ–¹æ¡ˆ

### 1. å¯åŠ¨è„šæœ¬é…ç½®

å·²åˆ›å»º `backend-java/start.sh`ï¼š

```bash
#!/bin/bash
# Javaåç«¯å¯åŠ¨è„šæœ¬

# è®¾ç½®Java 17
export JAVA_HOME=$(/usr/libexec/java_home -v 17)
export PATH=$JAVA_HOME/bin:$PATH

echo "ä½¿ç”¨Javaç‰ˆæœ¬:"
$JAVA_HOME/bin/java -version

cd "$(dirname "$0")"

echo ""
echo "æ­£åœ¨å¯åŠ¨Javaåç«¯..."
echo ""

# ä½¿ç”¨Java 17ç¼–è¯‘å¹¶å¯åŠ¨
JAVA_HOME=$(/usr/libexec/java_home -v 17) mvn spring-boot:run -Dspring-boot.run.profiles=dev
```

### 2. ç³»ç»ŸæœåŠ¡é…ç½®ï¼ˆå¯é€‰ï¼‰

åˆ›å»ºsystemdæœåŠ¡æˆ–launchdé…ç½®ï¼Œè®©Javaåç«¯å¼€æœºè‡ªåŠ¨å¯åŠ¨ï¼š

**macOS LaunchAgentç¤ºä¾‹** (`~/Library/LaunchAgents/com.cco.backend.plist`):

```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
    <key>Label</key>
    <string>com.cco.backend</string>
    <key>ProgramArguments</key>
    <array>
        <string>/Users/zhangyang/Documents/GitHub/CollectionONE/backend-java/start.sh</string>
    </array>
    <key>RunAtLoad</key>
    <true/>
    <key>StandardOutPath</key>
    <string>/Users/zhangyang/Documents/GitHub/CollectionONE/backend-java/backend.log</string>
    <key>StandardErrorPath</key>
    <string>/Users/zhangyang/Documents/GitHub/CollectionONE/backend-java/backend.error.log</string>
</dict>
</plist>
```

åŠ è½½æœåŠ¡ï¼š
```bash
launchctl load ~/Library/LaunchAgents/com.cco.backend.plist
```

### 3. ç¯å¢ƒå˜é‡é…ç½®

åœ¨ `~/.zshrc` æˆ– `~/.bash_profile` ä¸­æ·»åŠ ï¼š

```bash
# CCOé¡¹ç›®Javaé…ç½®
export CCO_JAVA_HOME=/opt/homebrew/opt/openjdk@17
alias cco-backend="cd /Users/zhangyang/Documents/GitHub/CollectionONE/backend-java && ./start.sh"
```

---

## ğŸ§ª æµ‹è¯•æ¸…å•

å®Œæˆä»¥ä¸‹æµ‹è¯•ç¡®ä¿404é”™è¯¯æ°¸ä¹…ä¿®å¤ï¼š

- [ ] Javaåç«¯æˆåŠŸå¯åŠ¨åœ¨8080ç«¯å£
- [ ] è®¿é—® `http://localhost:8080/api/v1/cases?tenantId=1` è¿”å›æ•°æ®
- [ ] è®¿é—® `http://localhost:8080/api/v1/field-display-configs?tenantId=1` è¿”å›æ•°æ®
- [ ] å‰ç«¯é¡µé¢åˆ·æ–°åä¸å†å‡ºç°404é”™è¯¯
- [ ] å‚¬å‘˜å·¥ä½œå°å¯ä»¥æ­£å¸¸åŠ è½½æ¡ˆä»¶åˆ—è¡¨
- [ ] å­—æ®µå±•ç¤ºé…ç½®æ­£å¸¸åŠ è½½

---

## ğŸ“ ä¸‹ä¸€æ­¥å·¥ä½œ

### çŸ­æœŸï¼ˆ1å‘¨å†…ï¼‰

1. âœ… å®ŒæˆJavaåç«¯Mockæ•°æ®æ¥å£
2. â³ æµ‹è¯•å‰ç«¯æ‰€æœ‰åŠŸèƒ½ä¸Javaåç«¯çš„å…¼å®¹æ€§
3. â³ åˆ é™¤Pythonåç«¯æ–‡ä»¶å¤¹ï¼ˆç¡®è®¤ä¸å†éœ€è¦åï¼‰

### ä¸­æœŸï¼ˆ1ä¸ªæœˆå†…ï¼‰

1. è¿æ¥çœŸå®MySQLæ•°æ®åº“
2. å®ç°å®Œæ•´çš„æ•°æ®æŒä¹…åŒ–
3. è¿ç§»æ›´å¤šPythonåç«¯åŠŸèƒ½åˆ°Java

### é•¿æœŸ

1. å®Œæˆ100%åŠŸèƒ½ä»Pythonåˆ°Javaçš„è¿ç§»
2. ä¼˜åŒ–Javaåç«¯æ€§èƒ½
3. æ·»åŠ å®Œæ•´çš„å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•

---

## ğŸ“Š å½“å‰çŠ¶æ€

| ç»„ä»¶ | çŠ¶æ€ | ç«¯å£ | è¯´æ˜ |
|------|------|------|------|
| Pythonåç«¯ | âŒ å·²åºŸå¼ƒ | 8000 | ä¸å†ä½¿ç”¨ |
| Javaåç«¯ | âœ… ä½¿ç”¨ä¸­ | 8080 | Mockæ•°æ®æ¨¡å¼ |
| å‰ç«¯ | âœ… å·²æ›´æ–° | 3000 | è¿æ¥Javaåç«¯ |

---

## âœ… æ€»ç»“

**é—®é¢˜**: å‰ç«¯404é”™è¯¯  
**åŸå› **: Pythonåç«¯å·²åºŸå¼ƒä½†å‰ç«¯ä»åœ¨è°ƒç”¨  
**è§£å†³**: å°†å‰ç«¯é…ç½®æ”¹ä¸ºè°ƒç”¨Javaåç«¯ï¼ˆ8080ç«¯å£ï¼‰  
**çŠ¶æ€**: å‰ç«¯é…ç½®å·²æ›´æ–°ï¼ŒJavaåç«¯Mockæ¥å£å·²å®ç°  
**ä¸‹ä¸€æ­¥**: å¯åŠ¨Javaåç«¯å¹¶éªŒè¯åŠŸèƒ½

---

**å½“å‰çŠ¶æ€**: ğŸŸ¡ Javaåç«¯ç¼–è¯‘æˆåŠŸï¼Œéœ€è¦å¯åŠ¨éªŒè¯  
**é¢„è®¡å®Œæˆæ—¶é—´**: ç«‹å³å¯ç”¨


