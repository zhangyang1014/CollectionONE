# æ ‡å‡†å­—æ®µæ•°æ®åº“é›†æˆå®ŒæˆæŠ¥å‘Š

## ğŸ“‹ æ¦‚è¿°

æˆåŠŸå°†æ ‡å‡†å­—æ®µç®¡ç†åŠŸèƒ½ä»Mockæ¨¡å¼è¿ç§»åˆ°æ•°æ®åº“æ¨¡å¼ï¼Œç°åœ¨å¯ä»¥ä»MySQLæ•°æ®åº“åŠ è½½çœŸå®çš„æ ‡å‡†å­—æ®µæ•°æ®ã€‚

**å®Œæˆæ—¶é—´**: 2025-12-05

## âœ… å·²å®Œæˆçš„å·¥ä½œ

### 1. åˆ›å»ºæ•°æ®åº“è®¿é—®å±‚

#### StandardFieldMapper
- **ä½ç½®**: `backend-java/src/main/java/com/cco/mapper/StandardFieldMapper.java`
- **è¯´æ˜**: åŸºäºMyBatis-Plusçš„æ•°æ®è®¿é—®æ¥å£
- **çŠ¶æ€**: âœ… å·²åˆ›å»ºå¹¶æ³¨å†Œåˆ°MapperConfig

#### StandardFieldServiceå®ç°
- **ä½ç½®**: `backend-java/src/main/java/com/cco/service/impl/StandardFieldServiceImpl.java`
- **åŠŸèƒ½**:
  - `listActive()` - è·å–æ‰€æœ‰å¯ç”¨çš„æ ‡å‡†å­—æ®µ
  - `listByGroupId(Long groupId)` - æ ¹æ®åˆ†ç»„IDè·å–å­—æ®µ
  - `getByFieldKey(String fieldKey)` - æ ¹æ®å­—æ®µKeyè·å–å­—æ®µ
- **çŠ¶æ€**: âœ… å·²å®Œæˆå®ç°

### 2. æ›´æ–°Controller

#### StandardFieldController
- **å˜æ›´**: ä»Mockæ•°æ®æ¨¡å¼æ”¹ä¸ºä½¿ç”¨Serviceä»æ•°æ®åº“è¯»å–
- **APIç«¯ç‚¹**:
  - `GET /api/v1/standard-fields` - è·å–æ‰€æœ‰å­—æ®µ
  - `GET /api/v1/standard-fields?field_group_id={id}` - æŒ‰åˆ†ç»„æŸ¥è¯¢
  - `GET /api/v1/standard-fields/{id}` - è·å–å•ä¸ªå­—æ®µï¼ˆå¾…å®ç°ï¼‰
- **çŠ¶æ€**: âœ… è¯»å–åŠŸèƒ½å·²å®Œæˆ

### 3. æ•°æ®åº“è¡¨åˆ›å»º

#### standard_fieldsè¡¨
- **è¯´æ˜**: å­˜å‚¨æ ‡å‡†å­—æ®µå®šä¹‰
- **å­—æ®µ**:
  - åŸºæœ¬ä¿¡æ¯: id, field_key, field_name, field_name_en
  - ç±»å‹ä¿¡æ¯: field_type, field_group_id
  - å±æ€§: is_required, is_extended, is_active, is_deleted
  - é…ç½®: enum_options, validation_rules
  - å…¶ä»–: description, example_value, sort_order
- **çŠ¶æ€**: âœ… å·²åˆ›å»º

### 4. æ•°æ®å¯¼å…¥

#### å¯¼å…¥æ•°æ®é‡
- **æ€»è®¡**: 74ä¸ªæ ‡å‡†å­—æ®µ
- **åˆ†ç»„åˆ†å¸ƒ**:
  - åŸºç¡€èº«ä»½ä¿¡æ¯ï¼ˆID: 11ï¼‰: 11ä¸ªå­—æ®µ
  - æ•™è‚²ä¿¡æ¯ï¼ˆID: 12ï¼‰: 3ä¸ªå­—æ®µ
  - èŒä¸šä¿¡æ¯ï¼ˆID: 13ï¼‰: 11ä¸ªå­—æ®µ
  - ç”¨æˆ·è¡Œä¸ºä¸ä¿¡ç”¨ï¼ˆID: 14ï¼‰: 10ä¸ªå­—æ®µ
  - è”ç³»æ–¹å¼ï¼ˆID: 15ï¼‰: 2ä¸ªå­—æ®µ
  - è´·æ¬¾è¯¦æƒ…ï¼ˆID: 2ï¼‰: 23ä¸ªå­—æ®µ
  - å€Ÿæ¬¾è®°å½•ï¼ˆID: 3ï¼‰: 14ä¸ªå­—æ®µ

**çŠ¶æ€**: âœ… éƒ¨åˆ†å®Œæˆï¼ˆ74/115ä¸ªå­—æ®µï¼‰

## âš ï¸ å·²çŸ¥é—®é¢˜

### 1. å­—æ®µé‡å¤é—®é¢˜

**é—®é¢˜**: SQLè„šæœ¬ä¸­å­˜åœ¨field_keyé‡å¤çš„å­—æ®µï¼Œå¯¼è‡´éƒ¨åˆ†å­—æ®µæ— æ³•å¯¼å…¥

**é‡å¤å­—æ®µç¤ºä¾‹**:
- `loan_id` - åœ¨åˆ†ç»„2å’Œåˆ†ç»„3ä¸­éƒ½å­˜åœ¨
- `user_id` - åœ¨åˆ†ç»„1å’Œåˆ†ç»„3ä¸­éƒ½å­˜åœ¨
- `user_name` - åœ¨åˆ†ç»„1å’Œåˆ†ç»„3ä¸­éƒ½å­˜åœ¨
- `mobile_number` - åœ¨è”ç³»æ–¹å¼å’Œå€Ÿæ¬¾è®°å½•ä¸­éƒ½å­˜åœ¨
- `overdue_days` - åœ¨å¤šä¸ªåˆ†ç»„ä¸­éƒ½å­˜åœ¨

**å·²ä¿®å¤**:
- âœ… å°†åˆ†ç»„3çš„`loan_id`æ”¹ä¸º`borrowing_loan_id`
- âœ… å°†åˆ†ç»„3çš„`user_id`æ”¹ä¸º`borrowing_user_id`
- âœ… å°†åˆ†ç»„3çš„`user_name`æ”¹ä¸º`borrowing_user_name`
- âœ… å°†åˆ†ç»„3çš„`mobile_number`æ”¹ä¸º`borrowing_mobile_number`

**å¾…ä¿®å¤**: è¿˜æœ‰çº¦41ä¸ªå­—æ®µå› é‡å¤é—®é¢˜æœªèƒ½å¯¼å…¥

### 2. å¤–é”®çº¦æŸé—®é¢˜

**é—®é¢˜**: schema.sqlä¸­çš„å¤–é”®çº¦æŸä¸MySQLç‰ˆæœ¬ä¸å…¼å®¹

**è§£å†³æ–¹æ¡ˆ**: åˆ›å»ºè¡¨æ—¶æš‚æ—¶ä¸æ·»åŠ å¤–é”®çº¦æŸ

## ğŸ“Š æµ‹è¯•ç»“æœ

### APIæµ‹è¯•

```bash
# æµ‹è¯•1: è·å–æ‰€æœ‰å­—æ®µ
curl http://localhost:8080/api/v1/standard-fields
# ç»“æœ: âœ… è¿”å›74ä¸ªå­—æ®µ

# æµ‹è¯•2: æŒ‰åˆ†ç»„æŸ¥è¯¢ï¼ˆåŸºç¡€èº«ä»½ä¿¡æ¯ï¼‰
curl 'http://localhost:8080/api/v1/standard-fields?field_group_id=11'
# ç»“æœ: âœ… è¿”å›11ä¸ªå­—æ®µï¼ŒåŒ…å«æšä¸¾é€‰é¡¹

# æµ‹è¯•3: æŒ‰åˆ†ç»„æŸ¥è¯¢ï¼ˆèŒä¸šä¿¡æ¯ï¼‰
curl 'http://localhost:8080/api/v1/standard-fields?field_group_id=13'
# ç»“æœ: âœ… è¿”å›11ä¸ªå­—æ®µ
```

### æ•°æ®ç¤ºä¾‹

```json
{
  "id": 3,
  "fieldKey": "gender",
  "fieldName": "æ€§åˆ«",
  "fieldNameEn": "gender",
  "fieldType": "Enum",
  "fieldGroupId": 11,
  "isRequired": false,
  "isExtended": false,
  "description": "ç”¨æˆ·æ€§åˆ«",
  "exampleValue": "Male / Female",
  "enumOptions": [
    {
      "standard_name": "Male",
      "standard_id": "male",
      "tenant_name": "Male",
      "tenant_id": "male"
    },
    {
      "standard_name": "Female",
      "standard_id": "female",
      "tenant_name": "Female",
      "tenant_id": "female"
    }
  ],
  "sortOrder": 3,
  "isActive": true
}
```

## ğŸ”§ åç»­å·¥ä½œ

### é«˜ä¼˜å…ˆçº§

1. **ä¿®å¤å­—æ®µé‡å¤é—®é¢˜**
   - [ ] åˆ†ææ‰€æœ‰é‡å¤å­—æ®µ
   - [ ] ä¸ºé‡å¤å­—æ®µæ·»åŠ é€‚å½“çš„å‰ç¼€æˆ–åç¼€
   - [ ] é‡æ–°æ‰§è¡ŒSQLè„šæœ¬å¯¼å…¥å‰©ä½™å­—æ®µ

2. **å®ç°CRUDåŠŸèƒ½**
   - [ ] å®ç°åˆ›å»ºå­—æ®µåŠŸèƒ½
   - [ ] å®ç°æ›´æ–°å­—æ®µåŠŸèƒ½
   - [ ] å®ç°åˆ é™¤å­—æ®µåŠŸèƒ½ï¼ˆè½¯åˆ é™¤ï¼‰
   - [ ] å®ç°å­—æ®µæ’åºåŠŸèƒ½

### ä¸­ä¼˜å…ˆçº§

3. **æ•°æ®å®Œæ•´æ€§**
   - [ ] æ·»åŠ æ•°æ®éªŒè¯
   - [ ] ç¡®ä¿æšä¸¾é€‰é¡¹çš„å®Œæ•´æ€§
   - [ ] æ£€æŸ¥æ‰€æœ‰å­—æ®µç±»å‹æ˜¯å¦æ­£ç¡®

4. **æ€§èƒ½ä¼˜åŒ–**
   - [ ] æ·»åŠ ç¼“å­˜å±‚
   - [ ] ä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½
   - [ ] æ·»åŠ åˆ†é¡µæ”¯æŒ

### ä½ä¼˜å…ˆçº§

5. **æ–‡æ¡£å®Œå–„**
   - [ ] APIæ–‡æ¡£
   - [ ] å­—æ®µè¯´æ˜æ–‡æ¡£
   - [ ] ä½¿ç”¨æŒ‡å—

## ğŸ“ ä½¿ç”¨è¯´æ˜

### å¯åŠ¨åç«¯

```bash
cd backend-java
JAVA_HOME=/opt/homebrew/opt/openjdk@17 \
PATH=/opt/homebrew/opt/openjdk@17/bin:$PATH \
mvn spring-boot:run -Dspring-boot.run.profiles=dev
```

æˆ–ä½¿ç”¨å¯åŠ¨è„šæœ¬ï¼š

```bash
cd backend-java
./start.sh
```

### å‰ç«¯è®¿é—®

å‰ç«¯é¡µé¢: http://localhost:5173/#/system/fields/standard

1. å·¦ä¾§æ ‘å½¢ç»“æ„æ˜¾ç¤ºå­—æ®µåˆ†ç»„
2. å³ä¾§è¡¨æ ¼æ˜¾ç¤ºè¯¥åˆ†ç»„ä¸‹çš„æ‰€æœ‰å­—æ®µ
3. ç‚¹å‡»åˆ†ç»„èŠ‚ç‚¹å¯ä»¥åˆ‡æ¢æŸ¥çœ‹ä¸åŒåˆ†ç»„çš„å­—æ®µ

## ğŸ¯ éªŒè¯æ¸…å•

- [x] StandardFieldMapperå·²åˆ›å»ºå¹¶æ³¨å†Œ
- [x] StandardFieldServiceå·²å®ç°
- [x] Controllerå·²æ›´æ–°ä½¿ç”¨Service
- [x] æ•°æ®åº“è¡¨å·²åˆ›å»º
- [x] éƒ¨åˆ†æ•°æ®å·²å¯¼å…¥ï¼ˆ74/115ï¼‰
- [x] APIæµ‹è¯•é€šè¿‡
- [x] æšä¸¾é€‰é¡¹æ­£å¸¸æ˜¾ç¤º
- [x] å‰ç«¯å¯ä»¥æ­£å¸¸è°ƒç”¨API

## ğŸ“š ç›¸å…³æ–‡ä»¶

### åç«¯ä»£ç 
- `backend-java/src/main/java/com/cco/mapper/StandardFieldMapper.java`
- `backend-java/src/main/java/com/cco/service/StandardFieldService.java`
- `backend-java/src/main/java/com/cco/service/impl/StandardFieldServiceImpl.java`
- `backend-java/src/main/java/com/cco/controller/StandardFieldController.java`
- `backend-java/src/main/java/com/cco/common/config/MapperConfig.java`

### æ•°æ®åº“è„šæœ¬
- `backend-java/src/main/resources/db/data/init_standard_fields.sql`

### å‰ç«¯é¡µé¢
- `frontend/src/views/field-config/StandardFields.vue`
- `frontend/src/api/field.ts`

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚é‡é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. Javaåç«¯æ˜¯å¦æ­£å¸¸å¯åŠ¨ï¼ˆç«¯å£8080ï¼‰
2. MySQLæ•°æ®åº“æ˜¯å¦å¯è¿æ¥
3. standard_fieldsè¡¨æ˜¯å¦å­˜åœ¨æ•°æ®
4. æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯

---

**æŠ¥å‘Šç”Ÿæˆæ—¶é—´**: 2025-12-05 18:18
**çŠ¶æ€**: âœ… åŸºæœ¬åŠŸèƒ½å·²å®Œæˆï¼Œéƒ¨åˆ†æ•°æ®å·²å¯¼å…¥







