# 权限系统使用指南

**版本**: v2.0  
**更新日期**: 2025-11-20

---

## 📚 目录

1. [概述](#概述)
2. [权限级别说明](#权限级别说明)
3. [角色权限概览](#角色权限概览)
4. [权限配置操作](#权限配置操作)
5. [常见问题](#常见问题)

---

## 概述

CCO系统采用基于角色的访问控制(RBAC)，通过权限矩阵管理不同角色对各功能模块的访问权限。

### 核心特性

- **三级权限**: 不可见、仅可见、可编辑
- **层级配置**: 上级角色可配置下级角色权限
- **多租户支持**: 系统默认配置 + 甲方自定义配置
- **可视化管理**: 交互式权限矩阵界面

---

## 权限级别说明

### 不可见 (None) ❌

- **含义**: 功能完全不可见，无法访问
- **表现**: 
  - 前端菜单不显示
  - API接口返回403禁止访问
  - 页面按钮隐藏

### 仅可见 (Readonly) 👁️

- **含义**: 可以查看但不能修改
- **表现**:
  - 可以进入页面查看数据
  - 编辑/删除按钮禁用或隐藏
  - 表单为只读模式

### 可编辑 (Editable) ✏️

- **含义**: 完全访问权限，可查看和修改
- **表现**:
  - 可以查看、创建、编辑、删除
  - 所有功能按钮可用
  - 完整的操作权限

---

## 角色权限概览

### SuperAdmin（超级管理员）

**权限范围**: 所有功能完全访问权限（67个权限点）

**主要职责**:
- 管理系统配置
- 管理所有甲方
- 配置标准字段
- 配置所有角色权限

**特殊说明**: SuperAdmin 拥有所有权限，无需单独配置

### TenantAdmin（甲方管理员）

**权限范围**: 除甲方管理外的全部功能（58个权限点）

**主要职责**:
- 管理本甲方的机构和小组
- 管理催员账号
- 配置甲方字段和队列
- 配置本甲方角色权限

**受限权限**:
- 只能查看自己所属的甲方
- 不能切换甲方
- 不能创建或删除甲方

### AgencyAdmin（机构管理员）

**权限范围**: 机构管理权限（43个权限点）

**主要职责**:
- 管理机构小组
- 管理催员
- 查看机构案件和业绩

**受限权限**:
- 只能管理自己所属的机构
- 不能创建机构

### TeamLeader（小组长）

**权限范围**: 小组管理权限（21个权限点）

**主要职责**:
- 查看小组案件
- 催收操作
- 查看组员业绩

**受限权限**:
- 只能查看自己小组的数据
- 不能添加或删除组员

### QualityInspector（质检员）

**权限范围**: 质检权限（3个权限点）

**主要职责**:
- 查看聊天记录
- 质检催员工作

**特殊说明**: 不能查看案件信息

### DataSource（数据源）

**权限范围**: 数据查看权限（6个权限点）

**主要职责**:
- 查看业绩数据
- 导出报表
- 数据分析

**特殊说明**: 不能查看案件和聊天内容

### Collector（催员）

**权限范围**: 个人案件权限（8个权限点）

**主要职责**:
- 查看自己的案件
- 催收操作
- 查看个人业绩

**受限权限**:
- 只能操作分配给自己的案件
- 部分字段只读

---

## 权限配置操作

### 访问权限配置页面

**路径**: 系统管理 > 权限配置

**权限要求**:
- SuperAdmin: 可配置所有角色
- TenantAdmin: 可配置本甲方内角色（除SuperAdmin）
- AgencyAdmin: 可配置机构内角色
- TeamLeader: 可配置小组内角色

### 选择配置级别

#### 系统默认配置

- 适用于所有甲方的默认权限
- 只有 SuperAdmin 可以配置
- 新建甲方自动继承此配置

#### 甲方自定义配置

- 仅对当前甲方生效
- 覆盖系统默认配置
- TenantAdmin 可以配置

### 修改权限

#### 方式1: 点击单元格切换

1. 找到要修改的权限行和角色列
2. 点击交叉单元格
3. 权限级别循环切换: ❌ → 👁️ → ✏️ → ❌

#### 方式2: 批量设置

1. 点击"批量设置"按钮
2. 选择目标角色
3. 选择权限级别
4. 选择应用范围（当前模块/所有模块）
5. 点击"应用"

### 保存配置

1. 完成权限修改后，点击"保存配置"
2. 确认保存提示
3. 系统保存所有修改

### 重置配置

- 点击"重置"按钮
- 恢复到上次保存的状态
- 所有未保存的修改会丢失

---

## 常见问题

### Q1: 修改权限后多久生效？

**A**: 立即生效。用户下次请求时就会应用新的权限配置。

### Q2: 甲方自定义配置和系统默认配置的关系？

**A**: 甲方自定义配置会覆盖系统默认配置。如果甲方没有自定义某个权限，则使用系统默认配置。

### Q3: 可以给某个角色添加新权限吗？

**A**: 权限点是系统预定义的，不能随意添加。但可以修改角色对现有权限的访问级别。

### Q4: 如何知道自己可以配置哪些角色？

**A**: 进入权限配置页面，系统会自动显示你可以配置的角色列表。

### Q5: 误删了甲方自定义配置怎么办？

**A**: 删除甲方自定义配置后，系统会自动使用默认配置，不会影响功能使用。

### Q6: SuperAdmin的权限可以被修改吗？

**A**: 不能。SuperAdmin 始终拥有所有权限，这是系统级设定。

### Q7: 如何导出当前的权限配置？

**A**: 点击页面右上角的"导出配置"按钮，可以导出Excel或PDF格式的权限矩阵。

### Q8: 权限配置会影响已登录的用户吗？

**A**: 会。权限配置修改后，用户的下一次操作就会使用新权限。无需重新登录。

### Q9: 如何恢复到系统默认配置？

**A**: 删除所有甲方自定义配置，系统会自动使用默认配置。

### Q10: 权限配置有操作日志吗？

**A**: 有。每次权限配置修改都会记录操作人和操作时间，可在系统日志中查看。

---

## 📞 技术支持

如有权限相关问题，请联系：

- **技术支持**: 系统管理员
- **文档反馈**: 提交Issue到项目仓库

---

**文档维护**: 系统管理员  
**最后更新**: 2025-11-20

