# é—®é¢˜ä¿®å¤è®°å½•

**åˆ›å»ºæ—¥æœŸ**: 2025-11-25  
**ç‰ˆæœ¬**: 1.0.0

---

## ğŸ“‹ é—®é¢˜ä¿®å¤æ—¶é—´çº¿

### 2025-11-25: å­—æ®µæ ¼å¼ç»Ÿä¸€ä¿®å¤

#### é—®é¢˜æè¿°
å‰ç«¯ä»£ç æœŸæœ›æ‰€æœ‰APIè¿”å›çš„å­—æ®µåä½¿ç”¨**ä¸‹åˆ’çº¿æ ¼å¼ï¼ˆsnake_caseï¼‰**ï¼Œä½†Javaåç«¯å¾ˆå¤šControllerè¿”å›çš„æ˜¯**é©¼å³°æ ¼å¼ï¼ˆcamelCaseï¼‰**ï¼Œå¯¼è‡´å‰ç«¯æ— æ³•æ­£ç¡®è¯»å–å­—æ®µæ•°æ®ã€‚

#### å½±å“èŒƒå›´
- å­—æ®µæ˜ å°„é…ç½®é¡µé¢ - æ˜¾ç¤º"æ²¡æœ‰å­—æ®µå†…å®¹"
- å­—æ®µåˆ†ç»„ç®¡ç†é¡µé¢ - åˆ†ç»„ä¿¡æ¯æ˜¾ç¤ºå¼‚å¸¸
- æ ‡å‡†å­—æ®µç®¡ç†é¡µé¢ - å­—æ®µæ•°æ®æ— æ³•æ˜¾ç¤º
- è‡ªå®šä¹‰å­—æ®µç®¡ç†é¡µé¢ - å­—æ®µæ•°æ®æ— æ³•æ˜¾ç¤º
- ç”²æ–¹ç®¡ç†é¡µé¢ - ç”²æ–¹ä¿¡æ¯æ˜¾ç¤ºå¼‚å¸¸

#### ä¿®å¤å†…å®¹

**ä¿®å¤çš„Controller**:
1. `StandardFieldController` - æ‰€æœ‰æ–¹æ³•å·²ä¿®å¤
2. `CustomFieldController` - æ‰€æœ‰æ–¹æ³•å·²ä¿®å¤
3. `FieldGroupController` - æ‰€æœ‰æ–¹æ³•å·²ä¿®å¤
4. `TenantController` - æ‰€æœ‰æ–¹æ³•å·²ä¿®å¤

**ä¿®å¤çš„å­—æ®µ**:
- `fieldKey` â†’ `field_key`
- `fieldName` â†’ `field_name`
- `fieldNameEn` â†’ `field_name_en`
- `fieldType` â†’ `field_type`
- `fieldGroupId` â†’ `field_group_id`
- `isRequired` â†’ `is_required`
- `isExtended` â†’ `is_extended`
- `exampleValue` â†’ `example_value`
- `sortOrder` â†’ `sort_order`
- `isActive` â†’ `is_active`
- `tenantCode` â†’ `tenant_code`
- `tenantName` â†’ `tenant_name`
- `countryCode` â†’ `country_code`
- `currencyCode` â†’ `currency_code`
- `groupKey` â†’ `group_key`
- `groupName` â†’ `group_name`
- `parentId` â†’ `parent_id`ï¼ˆæˆ–ä¸è®¾ç½®ï¼‰
- `createdAt` â†’ `created_at`
- `updatedAt` â†’ `updated_at`

#### æµ‹è¯•ç»“æœ
- âœ… `/api/v1/standard-fields` - æ ¼å¼æ­£ç¡®
- âœ… `/api/v1/field-groups` - æ ¼å¼æ­£ç¡®
- âœ… `/api/v1/tenants` - æ ¼å¼æ­£ç¡®
- âœ… `/api/v1/custom-fields` - æ ¼å¼æ­£ç¡®

---

### 2025-11-25: ç¼ºå¤±æ¥å£è¡¥å……

#### é—®é¢˜æè¿°
å‰ç«¯è°ƒç”¨äº†å¤§é‡APIæ¥å£ï¼Œä½†Javaåç«¯æ²¡æœ‰å®ç°ï¼Œå¯¼è‡´å‰ç«¯é¡µé¢å‡ºç°å¤§é‡500é”™è¯¯ã€‚

#### ç¼ºå¤±çš„æ¥å£åˆ—è¡¨

**æœºæ„ç®¡ç†ç›¸å…³**:
- âŒ `/api/v1/tenants/{tenantId}/agencies` - è·å–ç”²æ–¹æœºæ„åˆ—è¡¨
- âŒ `/api/v1/agencies` - æœºæ„ç®¡ç†æ¥å£
- âŒ `/api/v1/agencies/{agencyId}/teams` - è·å–æœºæ„å°ç»„åˆ—è¡¨

**å°ç»„ç¾¤ç®¡ç†ç›¸å…³**:
- âŒ `/api/v1/team-groups` - å°ç»„ç¾¤ç®¡ç†æ¥å£

**å°ç»„ç®¡ç†ç›¸å…³**:
- âŒ `/api/v1/teams` - å°ç»„ç®¡ç†æ¥å£

**é˜Ÿåˆ—ç®¡ç†ç›¸å…³**:
- âŒ `/api/v1/tenants/{tenantId}/queues` - è·å–ç”²æ–¹é˜Ÿåˆ—åˆ—è¡¨
- âŒ `/api/v1/queues` - é˜Ÿåˆ—ç®¡ç†æ¥å£

**å­—æ®µç®¡ç†ç›¸å…³**:
- âŒ `/api/v1/tenants/{tenantId}/fields-json` - è·å–ç”²æ–¹å­—æ®µJSON
- âŒ `/api/v1/tenants/{tenantId}/unmapped-fields` - è·å–æœªæ˜ å°„å­—æ®µ
- âŒ `/api/v1/field-groups` - å­—æ®µåˆ†ç»„æ¥å£
- âŒ `/api/v1/custom-fields` - è‡ªå®šä¹‰å­—æ®µæ¥å£
- âŒ `/api/v1/standard-fields` - æ ‡å‡†å­—æ®µæ¥å£

**ç»©æ•ˆç®¡ç†ç›¸å…³**:
- âŒ `/api/v1/performance/collector/{collectorId}` - å‚¬å‘˜ç»©æ•ˆæ¥å£

#### ä¿®å¤å†…å®¹

**æ–°å¢Controller**:
1. `AgencyController` - æœºæ„ç®¡ç†
2. `TeamGroupController` - å°ç»„ç¾¤ç®¡ç†
3. `TeamController` - å°ç»„ç®¡ç†
4. `QueueController` - é˜Ÿåˆ—ç®¡ç†

**æ–°å¢æ¥å£æ–¹æ³•**:
- `TenantController.getTenantAgencies()` - è·å–ç”²æ–¹æœºæ„åˆ—è¡¨
- `TenantController.getTenantQueues()` - è·å–ç”²æ–¹é˜Ÿåˆ—åˆ—è¡¨
- `TenantController.getTenantFieldsJson()` - è·å–ç”²æ–¹å­—æ®µJSON
- `TenantController.getUnmappedTenantFields()` - è·å–æœªæ˜ å°„å­—æ®µ
- `AgencyController.getAgencyTeams()` - è·å–æœºæ„å°ç»„åˆ—è¡¨

#### æµ‹è¯•ç»“æœ
- âœ… `/api/v1/tenants/1/agencies` - æ­£å¸¸
- âœ… `/api/v1/agencies?tenant_id=1` - æ­£å¸¸
- âœ… `/api/v1/team-groups?tenant_id=1` - æ­£å¸¸
- âœ… `/api/v1/tenants/1/queues` - æ­£å¸¸
- âœ… `/api/v1/agencies/1/teams` - æ­£å¸¸
- âœ… `/api/v1/agencies/2/teams` - æ­£å¸¸

---

### 2025-11-25: parent_idå­—æ®µç±»å‹ä¿®å¤

#### é—®é¢˜æè¿°
åç«¯è¿”å›çš„ `parent_id` ä¸º `null`ï¼Œä½†å‰ç«¯ç±»å‹å®šä¹‰ä¸º `parent_id?: number`ï¼ˆ`number | undefined`ï¼‰ï¼Œç±»å‹ä¸ä¸€è‡´ã€‚

#### ä¿®å¤å†…å®¹
- ä¸€çº§åˆ†ç»„çš„ `parent_id` å­—æ®µä¸è®¾ç½®ï¼ˆundefinedï¼‰ï¼Œè€Œä¸æ˜¯è®¾ç½®ä¸º `null`

#### ä¿®å¤å‰
```java
group.put("parent_id", null);  // âŒ é”™è¯¯
```

#### ä¿®å¤å
```java
// âœ… æ­£ç¡®ï¼šä¸è®¾ç½®parent_idå­—æ®µï¼ˆä¸€çº§åˆ†ç»„ï¼‰
// parent_idä¸è®¾ç½®ï¼Œè¡¨ç¤ºä¸€çº§åˆ†ç»„
```

---

## ğŸ” é—®é¢˜æ ¹å› åˆ†æ

### æ ¹å› 1: ç¼ºä¹ç»Ÿä¸€çš„å¼€å‘è§„èŒƒ

**é—®é¢˜**: æ²¡æœ‰æ˜ç¡®çš„å­—æ®µæ ¼å¼è§„èŒƒï¼Œå¯¼è‡´å‰åç«¯æ ¼å¼ä¸ä¸€è‡´ã€‚

**è§£å†³æ–¹æ¡ˆ**: 
- åˆ¶å®šç»Ÿä¸€çš„å­—æ®µæ ¼å¼è§„èŒƒï¼ˆä¸‹åˆ’çº¿æ ¼å¼ï¼‰
- åˆ›å»ºå¼€å‘è§„èŒƒæ–‡æ¡£
- å»ºç«‹ä»£ç å®¡æŸ¥æ£€æŸ¥ç‚¹

### æ ¹å› 2: æ¥å£å®ç°ä¸å®Œæ•´

**é—®é¢˜**: å‰ç«¯å¼€å‘æ—¶å‡è®¾åç«¯æ¥å£å·²å®ç°ï¼Œä½†å®é™…æœªå®ç°ã€‚

**è§£å†³æ–¹æ¡ˆ**:
- å»ºç«‹æ¥å£æ¸…å•
- å¼€å‘å‰æ£€æŸ¥æ¥å£å®Œæ•´æ€§
- ä½¿ç”¨Mockæ•°æ®å¿«é€Ÿå®ç°æ¥å£

### æ ¹å› 3: ç¼ºä¹è‡ªåŠ¨åŒ–æ£€æŸ¥

**é—®é¢˜**: ä¾èµ–äººå·¥æ£€æŸ¥ï¼Œå®¹æ˜“é—æ¼ã€‚

**è§£å†³æ–¹æ¡ˆ**:
- åˆ›å»ºè‡ªåŠ¨åŒ–æ£€æŸ¥è„šæœ¬
- é›†æˆåˆ°CI/CDæµç¨‹
- ä½¿ç”¨grepæ£€æŸ¥å­—æ®µæ ¼å¼

---

## ğŸ“Š ä¿®å¤ç»Ÿè®¡

### ä¿®å¤çš„Controlleræ•°é‡
- æ ‡å‡†Controller: 4ä¸ªï¼ˆStandardFieldController, CustomFieldController, FieldGroupController, TenantControllerï¼‰
- æ–°å¢Controller: 4ä¸ªï¼ˆAgencyController, TeamGroupController, TeamController, QueueControllerï¼‰

### ä¿®å¤çš„æ¥å£æ•°é‡
- ä¿®å¤çš„æ¥å£: 20+ä¸ª
- æ–°å¢çš„æ¥å£: 15+ä¸ª

### ä¿®å¤çš„å­—æ®µæ•°é‡
- ä¿®å¤çš„å­—æ®µæ ¼å¼: 20+ä¸ªå­—æ®µ

---

## ğŸ¯ é¢„é˜²æªæ–½

### 1. å¼€å‘å‰æ£€æŸ¥
- [ ] æ£€æŸ¥å‰ç«¯APIè°ƒç”¨æ¸…å•
- [ ] æ£€æŸ¥åç«¯æ¥å£å®ç°æ¸…å•
- [ ] å¯¹æ¯”å·®å¼‚ï¼Œè¡¥å……ç¼ºå¤±æ¥å£

### 2. å¼€å‘ä¸­æ£€æŸ¥
- [ ] ç¡®ä¿å­—æ®µæ ¼å¼ä½¿ç”¨ä¸‹åˆ’çº¿æ ¼å¼
- [ ] ç¡®ä¿å¯é€‰å­—æ®µæ­£ç¡®å¤„ç†
- [ ] ç¡®ä¿æ¥å£è·¯å¾„æ­£ç¡®

### 3. å¼€å‘åæ£€æŸ¥
- [ ] ä½¿ç”¨grepæ£€æŸ¥å­—æ®µæ ¼å¼
- [ ] æµ‹è¯•æ‰€æœ‰æ¥å£
- [ ] æµ‹è¯•å‰ç«¯é¡µé¢

### 4. ä»£ç å®¡æŸ¥
- [ ] æ£€æŸ¥å­—æ®µæ ¼å¼
- [ ] æ£€æŸ¥æ¥å£å®Œæ•´æ€§
- [ ] æ£€æŸ¥é”™è¯¯å¤„ç†

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [APIæ¥å£å¼€å‘è§„èŒƒ](./APIæ¥å£å¼€å‘è§„èŒƒ.md)
- [å­—æ®µæ ¼å¼ç»Ÿä¸€ä¿®å¤è¯´æ˜](../é—®é¢˜åˆ†æ/å­—æ®µæ ¼å¼ç»Ÿä¸€ä¿®å¤è¯´æ˜.md)
- [å‰ç«¯APIè°ƒç”¨è§„åˆ™](../../.cursor/rules/frontend-api.mdc)
- [åç«¯APIå¼€å‘è§„åˆ™](../../.cursor/rules/backend-api.mdc)

---

**æœ€åæ›´æ–°**: 2025-11-25  
**ç»´æŠ¤äººå‘˜**: å¼€å‘å›¢é˜Ÿ  
**ç‰ˆæœ¬**: 1.0.0
































