# å¿«é€ŸéªŒè¯æŒ‡å— - IMç«¯æ¡ˆä»¶åŠŸèƒ½ä¿®å¤å®Œæˆ

## âœ… å·²å®Œæˆçš„ä¿®å¤

### 1. æ¡ˆä»¶åˆ—è¡¨APIä¿®å¤
- **é—®é¢˜**: å‚æ•°å‘½åä¸åŒ¹é…ï¼ˆå‰ç«¯ä½¿ç”¨ä¸‹åˆ’çº¿ï¼Œåç«¯ä½¿ç”¨é©¼å³°ï¼‰
- **è§£å†³**: ä¿®æ”¹Javaåç«¯å‚æ•°æ³¨è§£ï¼Œæ”¯æŒ `tenant_id`, `collector_id`, `page_size`
- **æ–‡ä»¶**: `backend-java/src/main/java/com/cco/controller/MockCaseController.java`

### 2. å‚¬å‘˜IDæ˜ å°„ä¿®å¤
- **é—®é¢˜**: BT0001ç™»å½•åè¿”å›çš„æ˜¯å­—ç¬¦ä¸²IDï¼Œæ¡ˆä»¶APIéœ€è¦æ•°å­—ID
- **è§£å†³**: 
  - åç«¯ç™»å½•APIè¿”å› `collectorIdNumeric: 43`ï¼ˆBT0001åœ¨æ•°æ®åº“ä¸­çš„å®é™…IDï¼‰
  - å‰ç«¯ä½¿ç”¨ `collectorIdNumeric` è€Œä¸æ˜¯å­—ç¬¦ä¸² `id` æ¥æŸ¥è¯¢æ¡ˆä»¶
- **æ–‡ä»¶**: 
  - `backend-java/src/main/java/com/cco/controller/MockImController.java`
  - `frontend/src/views/im/CollectorWorkspace.vue`

### 3. å“åº”æ•°æ®æ ¼å¼å…¼å®¹
- **é—®é¢˜**: Javaåç«¯è¿”å›åˆ†é¡µå¯¹è±¡ `{data: {items: [...]}}`ï¼Œå‰ç«¯æœŸæœ›æ•°ç»„
- **è§£å†³**: å‰ç«¯æ™ºèƒ½è¯†åˆ«å¤šç§å“åº”æ ¼å¼
- **æ–‡ä»¶**: `frontend/src/views/im/CollectorWorkspace.vue`

### 4. æ–°å¢æ”¯ä»˜ç›¸å…³API
- **é—®é¢˜**: ç¼ºå°‘è¿˜æ¬¾ç å’Œæ”¯ä»˜æ¸ é“APIï¼Œå¯¼è‡´500é”™è¯¯
- **è§£å†³**: åˆ›å»º `MockPaymentController.java`ï¼Œæä¾›ä»¥ä¸‹APIï¼š
  - `GET /api/v1/im/payment-codes` - è·å–è¿˜æ¬¾ç åˆ—è¡¨
  - `POST /api/v1/im/payment-codes` - ç”Ÿæˆè¿˜æ¬¾ç 
  - `GET /api/v1/im/payment-codes/{id}` - è·å–è¿˜æ¬¾ç è¯¦æƒ…
  - `POST /api/v1/im/payment-codes/{id}/send` - å‘é€è¿˜æ¬¾ç 
  - `POST /api/v1/im/payment-codes/{id}/expire` - ä½¿è¿˜æ¬¾ç å¤±æ•ˆ
  - `GET /api/v1/im/payment-channels` - è·å–å¯ç”¨æ”¯ä»˜æ¸ é“
- **æ–‡ä»¶**: `backend-java/src/main/java/com/cco/controller/MockPaymentController.java`

## ğŸ“‹ å¿«é€ŸéªŒè¯æ­¥éª¤

### ç¬¬1æ­¥ï¼šç¡®è®¤Javaåç«¯æ­£åœ¨è¿è¡Œ
```bash
lsof -ti:8080
# åº”è¯¥è¿”å›è¿›ç¨‹ID
```

### ç¬¬2æ­¥ï¼šæ¸…é™¤æ—§çš„ç™»å½•æ•°æ®
1. æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·ï¼ˆF12ï¼‰
2. Application â†’ Local Storage
3. åˆ é™¤ `im_token` å’Œ `im_user`

### ç¬¬3æ­¥ï¼šé‡æ–°ç™»å½•
- æœºæ„IDï¼š`1`
- å‚¬å‘˜IDï¼š`BT0001`
- å¯†ç ï¼š`123456`

### ç¬¬4æ­¥ï¼šéªŒè¯åŠŸèƒ½
ç™»å½•æˆåŠŸååº”è¯¥çœ‹åˆ°ï¼š
- âœ… å·¦ä¾§æ˜¾ç¤º **15ä¸ªæ¡ˆä»¶**
- âœ… æ¡ˆä»¶ç¼–å·æ ¼å¼ï¼š`BT0043_CASE_001_20251121`
- âœ… ç‚¹å‡»æ¡ˆä»¶æŸ¥çœ‹è¯¦æƒ…æ­£å¸¸
- âœ… è¿˜æ¬¾ç æ ‡ç­¾é¡µæ­£å¸¸ï¼ˆä¸å†æŠ¥500é”™è¯¯ï¼‰
- âœ… å¯ç”¨æ”¯ä»˜æ¸ é“æ­£å¸¸æ˜¾ç¤º

## ğŸ” APIæµ‹è¯•å‘½ä»¤

### æµ‹è¯•æ¡ˆä»¶åˆ—è¡¨API
```bash
curl -s "http://localhost:8080/api/v1/cases?tenant_id=1&collector_id=43" | python3 -m json.tool
```

### æµ‹è¯•è¿˜æ¬¾ç API
```bash
curl -s "http://localhost:8080/api/v1/im/payment-codes?case_id=91&page=1&page_size=100" | python3 -m json.tool
```

### æµ‹è¯•æ”¯ä»˜æ¸ é“API
```bash
curl -s "http://localhost:8080/api/v1/im/payment-channels?party_id=1" | python3 -m json.tool
```

### æµ‹è¯•ç™»å½•API
```bash
curl -s -X POST "http://localhost:8080/api/v1/im/auth/login" \
  -H "Content-Type: application/json" \
  -d '{"tenantId": "1", "collectorId": "BT0001", "password": "123456"}' | python3 -m json.tool
```

## ğŸ“Š Mockæ•°æ®è¯´æ˜

### æ¡ˆä»¶æ•°æ®ï¼ˆ15ä¸ªï¼‰
- æ¡ˆä»¶ID: 91-105
- å‚¬å‘˜ID: 43ï¼ˆå¯¹åº”BT0001ï¼‰
- ç§Ÿæˆ·ID: 1
- è´·æ¬¾é‡‘é¢: 5,000 - 45,000 MXN
- é€¾æœŸå¤©æ•°: 5-80å¤©
- çŠ¶æ€: pending_repayment, partial_repayment

### è¿˜æ¬¾ç æ•°æ®ï¼ˆæ¯ä¸ªæ¡ˆä»¶3-5ä¸ªï¼‰
- æ¸ é“: OXXO, SPEI, Bank Transfer, 7-Eleven, PayPal
- é‡‘é¢: 5,000 - 15,000 MXN
- çŠ¶æ€: active, expired, used
- æœ‰æ•ˆæœŸ: 7å¤©
- åŒ…å«äºŒç»´ç URL

### æ”¯ä»˜æ¸ é“ï¼ˆ4ä¸ªï¼‰
1. OXXOä¾¿åˆ©åº— - ç°é‡‘æ”¯ä»˜ï¼Œ100-50,000 MXN
2. SPEIé“¶è¡Œè½¬è´¦ - å³æ—¶è½¬è´¦ï¼Œ100-1,000,000 MXN
3. é“¶è¡Œè½¬è´¦ - ä¼ ç»Ÿè½¬è´¦ï¼Œ100-1,000,000 MXN
4. 7-Elevenä¾¿åˆ©åº— - ç°é‡‘æ”¯ä»˜ï¼Œ100-30,000 MXN

## ğŸš€ é‡å¯æœåŠ¡ï¼ˆå¦‚éœ€è¦ï¼‰

### é‡å¯Javaåç«¯
```bash
cd /Users/zhangyang/Documents/GitHub/CollectionONE/backend-java
lsof -ti:8080 | xargs kill -9
JAVA_HOME=/opt/homebrew/opt/openjdk@17 PATH=/opt/homebrew/opt/openjdk@17/bin:$PATH \
  mvn spring-boot:run -Dspring-boot.run.profiles=dev > backend.log 2>&1 &
```

### é‡å¯å‰ç«¯ï¼ˆå¦‚éœ€è¦ï¼‰
```bash
cd /Users/zhangyang/Documents/GitHub/CollectionONE/frontend
npm run dev
```

## ğŸ“ å…³é”®æ–‡ä»¶æ¸…å•

### åç«¯æ–‡ä»¶
- `backend-java/src/main/java/com/cco/controller/MockCaseController.java` - æ¡ˆä»¶API
- `backend-java/src/main/java/com/cco/controller/MockImController.java` - ç™»å½•API
- `backend-java/src/main/java/com/cco/controller/MockPaymentController.java` - æ”¯ä»˜APIï¼ˆæ–°å¢ï¼‰

### å‰ç«¯æ–‡ä»¶
- `frontend/src/views/im/CollectorWorkspace.vue` - å‚¬å‘˜å·¥ä½œå°
- `frontend/src/api/im.ts` - IMç«¯APIæ¥å£
- `frontend/src/api/imCase.ts` - æ¡ˆä»¶APIæ¥å£
- `frontend/src/utils/imRequest.ts` - IMç«¯è¯·æ±‚å·¥å…·

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **Javaç‰ˆæœ¬**: å¿…é¡»ä½¿ç”¨Java 17ï¼Œä¸è¦ä½¿ç”¨Java 25
2. **ç«¯å£**: Javaåç«¯å›ºå®š8080ï¼Œå‰ç«¯å›ºå®š5173
3. **ç™»å½•æ•°æ®**: æ¯æ¬¡ä¿®æ”¹ç™»å½•é€»è¾‘åéœ€è¦æ¸…é™¤localStorageé‡æ–°ç™»å½•
4. **Mockæ•°æ®**: å½“å‰æ‰€æœ‰æ•°æ®éƒ½æ˜¯Mockï¼Œä¸è¿æ¥çœŸå®æ•°æ®åº“
5. **äºŒç»´ç URL**: ä½¿ç”¨å…¬å…±APIç”Ÿæˆï¼Œéœ€è¦ç½‘ç»œè¿æ¥

## ğŸ¯ ä¸‹ä¸€æ­¥è®¡åˆ’

1. æ ¹æ®å®é™…ä¸šåŠ¡éœ€æ±‚è¿æ¥çœŸå®æ•°æ®åº“
2. å®ç°çœŸå®çš„æ”¯ä»˜ç½‘å…³é›†æˆ
3. æ·»åŠ æ›´å¤šä¸šåŠ¡é€»è¾‘éªŒè¯
4. ä¼˜åŒ–Mockæ•°æ®æ›´åŠ è´´è¿‘çœŸå®åœºæ™¯

---

**æœ€åæ›´æ–°**: 2025-11-23  
**ç‰ˆæœ¬**: 1.1.0  
**ä¿®å¤äºº**: AI Assistant
