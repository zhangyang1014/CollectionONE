# 标准字段CSV查看功能说明

## 版本变更记录

| 版本 | 日期 | 变更内容 | 变更人 |
|------|------|----------|--------|
| 1.0.0 | 2025-12-11 | 初始创建，实现基于CSV的标准字段查看功能 | 大象 |

## 功能概述

该功能提供了一个全新的页面，用于查看和浏览基于CSV文件定义的标准字段。所有字段数据来源于 `参考内容/` 目录下的CSV文件。

### 主要特性

1. **分组标签式导航**：页面顶部显示所有字段分组的标签按钮
2. **点击切换**：点击不同分组标签，右侧表格显示对应分组的字段
3. **字段详情**：显示字段名称、标识、类型、枚举值、示例、说明等完整信息
4. **搜索筛选**：支持按字段名称、类型、是否拓展字段等条件筛选
5. **分页显示**：支持分页浏览，可调整每页显示数量

## 数据来源

所有标准字段数据来自以下CSV文件：

| CSV文件 | 对应分组 | 字段数量 |
|---------|----------|----------|
| CCO催收字段集合-客户基础信息.csv | 基础身份信息、教育信息、职业信息、用户行为与信用、联系方式 | 37个 |
| CCO催收字段集合-贷款详情.csv | 贷款详情 | 23个 |
| CCO催收字段集合-分期详情.csv | 分期详情 | 16个 |
| CCO催收字段集合-还款记录.csv | 还款记录 | 13个 |
| CCO催收字段集合-历史借款记录.csv | 历史借款记录 | 26个 |

**总计：115个标准字段**

## 字段分组结构

### 一级分组

1. **客户基础信息** (customer_info)
   - 包含5个子分组
   - 共37个字段

2. **贷款详情** (loan_details)
   - 共23个字段

3. **分期详情** (installment_details)
   - 共16个字段

4. **还款记录** (repayment_records)
   - 共13个字段

5. **历史借款记录** (loan_history)
   - 共26个字段

### 二级分组（客户基础信息下）

1. **基础身份信息** (identity_info) - 11个字段
2. **教育信息** (education_info) - 3个字段
3. **职业信息** (employment_info) - 11个字段
4. **用户行为与信用** (behavior_credit) - 10个字段
5. **联系方式** (contact_info) - 2个字段

## 使用指南

### 1. 访问页面

在主菜单中，导航到：

```
案件详情字段管理 → 标准字段查看（CSV）
```

或直接访问URL：

```
http://localhost:5173/field-config/detail/standard-csv
```

### 2. 浏览字段

#### 方法一：按分组浏览

1. 页面顶部显示所有分组的标签按钮
2. 点击任意分组标签（如"基础身份信息"）
3. 右侧表格自动显示该分组的所有字段

#### 方法二：查看全部字段

点击"全部"标签，显示所有115个标准字段

### 3. 搜索和筛选

#### 搜索字段

在搜索框中输入字段名称或标识，实时筛选结果：

```
示例：输入"用户" → 显示所有包含"用户"的字段
示例：输入"user_id" → 精确查找特定字段
```

#### 按类型筛选

使用"筛选字段类型"下拉框，选择特定类型：

- String（字符串）
- Integer（整数）
- Decimal（小数）
- Date（日期）
- Datetime（日期时间）
- Enum（枚举）
- Boolean（布尔值）
- Button（按钮）
- FileList（文件列表）

#### 按拓展字段筛选

使用"筛选拓展字段"下拉框：

- **标准字段**：系统核心字段，必须存在
- **拓展字段**：可选字段，根据业务需求添加

### 4. 查看字段详情

表格显示每个字段的以下信息：

| 列名 | 说明 | 示例 |
|------|------|------|
| 序号 | 自动编号 | 1, 2, 3... |
| 分组 | 所属分组名称 | 基础身份信息 |
| 字段名称 | 中文名称 | 用户编号 |
| 字段标识 | 英文键名 | user_id |
| 字段类型 | 数据类型 | String |
| 枚举值 | 可选值（仅Enum类型） | Male / Female |
| 示例 | 示例数据 | 5983 |
| 拓展字段 | 是否为拓展字段 | 是/否 |
| 说明 | 字段用途说明 | 系统内部唯一用户标识 |

## 页面截图说明

### 页面布局

```
┌─────────────────────────────────────────────────────────┐
│ 案件详情标准字段查看（基于CSV） [标准字段参考]          │
├─────────────────────────────────────────────────────────┤
│ ┌─────────────────────────────────────────────────────┐ │
│ │ [全部 37] [客户基础信息 37] [基础身份信息 11]      │ │
│ │ [教育信息 3] [职业信息 11] [用户行为与信用 10]     │ │
│ │ [联系方式 2] [贷款详情 23] [分期详情 16]           │ │
│ │ [还款记录 13] [历史借款记录 26]                     │ │
│ └─────────────────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────────┤
│ ℹ 当前分组：基础身份信息，共 11 个字段                  │
├─────────────────────────────────────────────────────────┤
│ 🔍[搜索框] [类型筛选▼] [拓展字段筛选▼]                 │
├─────────────────────────────────────────────────────────┤
│ ┌─────┬──────┬────────┬─────┬────┬────┬────┬────┬────┐ │
│ │序号 │字段名│字段标识│类型 │枚举│示例│拓展│说明│    │ │
│ ├─────┼──────┼────────┼─────┼────┼────┼────┼────┼────┤ │
│ │  1  │用户编│user_id │Stri-│ -  │5983│ 否 │系统│    │ │
│ │     │号    │        │ng   │    │    │    │内部│    │ │
│ ├─────┼──────┼────────┼─────┼────┼────┼────┼────┼────┤ │
│ │  2  │用户姓│user_na-│Stri-│ -  │Juan│ 否 │借款│    │ │
│ │     │名    │me      │ng   │    │... │    │人姓│    │ │
│ └─────┴──────┴────────┴─────┴────┴────┴────┴────┴────┘ │
│                                                          │
│ 共 11 条  [20▼] [◀] [1] [2] [▶]                        │
└─────────────────────────────────────────────────────────┘
```

## 技术实现

### 文件结构

```
frontend/src/
├── data/
│   └── standardFieldsFromCSV.ts      # CSV数据转换为TS格式
├── views/field-config/
│   └── StandardFieldsFromCSV.vue     # 标准字段查看页面
└── router/index.ts                   # 路由配置
```

### 核心代码

#### 1. 数据结构定义

```typescript
export interface StandardField {
  field_name: string          // 字段名称
  field_key: string           // 字段标识
  field_type: string          // 字段类型
  example?: string            // 示例
  description: string         // 说明
  is_extension: boolean       // 是否为拓展字段
  enum_values?: string[]      // 枚举值
  group_key: string           // 分组标识
  group_name: string          // 分组名称
}
```

#### 2. 分组点击处理

```typescript
const handleGroupClick = (groupKey: string) => {
  activeGroup.value = groupKey
  currentPage.value = 1
}
```

#### 3. 字段筛选逻辑

```typescript
const filteredFields = computed(() => {
  let result = [...allFields.value]
  
  // 分组筛选
  if (activeGroup.value !== 'all') {
    // 检查是否是父分组
    const isParentGroup = fieldGroups.find(g => 
      g.group_key === activeGroup.value && !g.parent_key
    )
    
    if (isParentGroup) {
      // 显示所有子分组的字段
      const childGroups = fieldGroups.filter(g => 
        g.parent_key === activeGroup.value
      )
      const childGroupKeys = childGroups.map(g => g.group_key)
      result = result.filter(f => childGroupKeys.includes(f.group_key))
    } else {
      // 只显示该分组的字段
      result = result.filter(f => f.group_key === activeGroup.value)
    }
  }
  
  return result
})
```

## 使用场景

### 场景1：查看特定分组的字段

**需求**：了解"基础身份信息"分组包含哪些字段

**操作步骤**：
1. 点击"基础身份信息"标签
2. 查看右侧表格显示的11个字段
3. 确认包含：用户编号、用户姓名、性别、证件号码等

### 场景2：搜索特定字段

**需求**：查找"逾期天数"字段的定义

**操作步骤**：
1. 在搜索框输入"逾期"
2. 系统自动筛选显示包含"逾期"的字段
3. 查看字段详情：类型、示例、说明

### 场景3：查看Enum类型字段

**需求**：了解所有枚举类型的字段及其可选值

**操作步骤**：
1. 在"筛选字段类型"下拉框选择"Enum"
2. 表格显示所有枚举字段
3. "枚举值"列显示每个字段的可选值

### 场景4：区分标准字段和拓展字段

**需求**：确认哪些是必须的标准字段

**操作步骤**：
1. 在"筛选拓展字段"下拉框选择"标准字段"
2. 表格显示所有非拓展字段
3. 这些字段是系统必须支持的核心字段

## 字段示例

### 基础身份信息示例

| 字段名称 | 字段标识 | 类型 | 枚举值 | 示例 | 拓展 |
|----------|----------|------|--------|------|------|
| 用户编号 | user_id | String | - | 5983 | 否 |
| 用户姓名 | user_name | String | - | Juan Dela Cruz | 否 |
| 性别 | gender | Enum | Male / Female | Male | 否 |
| 婚姻状况 | marital_status | Enum | Single / Married | Single | 否 |
| 国籍 | nationality | String | - | Philippines | 是 |

### 贷款详情示例

| 字段名称 | 字段标识 | 类型 | 示例 | 拓展 |
|----------|----------|------|------|------|
| 贷款编号 | loan_id | String | 123 | 否 |
| 应还金额 | total_due_amount | Decimal | 1460 | 否 |
| 已还金额 | total_paid_amount | Decimal | 975 | 否 |
| 当前逾期天数 | overdue_days | Integer | 3 | 是 |

### 还款记录示例

| 字段名称 | 字段标识 | 类型 | 枚举值 | 拓展 |
|----------|----------|------|--------|------|
| 还款时间 | repayment_time | Datetime | - | 否 |
| 还款类型 | repayment_type | Enum | 部分还款 / 全额还款 / 提前还款 | 否 |
| 还款金额 | repayment_amount | Decimal | - | 否 |

## 常见问题

### Q1: 为什么点击"客户基础信息"显示的字段数量和其他不一样？

**A**: "客户基础信息"是一级分组，包含5个子分组。点击它会显示所有子分组的字段（共37个）。如果只想看某个子分组，请点击具体的子分组标签，如"基础身份信息"。

### Q2: 如何快速找到某个字段？

**A**: 使用页面顶部的搜索框，输入字段名称或标识的部分文字即可实时筛选。

### Q3: 枚举值列显示"等X个"是什么意思？

**A**: 当枚举值数量超过3个时，只显示前3个，后面显示"等X个"表示总数。鼠标悬停可查看完整内容。

### Q4: 标准字段和拓展字段的区别？

**A**: 
- **标准字段**：系统核心字段，所有甲方必须提供
- **拓展字段**：可选字段，根据业务需求灵活添加

### Q5: 这个页面的数据可以修改吗？

**A**: 不可以。这是只读页面，用于查看标准字段定义。数据来源于CSV文件，作为字段配置的参考标准。

### Q6: 为什么有些字段没有示例值？

**A**: 部分字段在CSV中未定义示例值，表格中会显示"-"。这不影响字段的使用，字段说明栏会描述字段用途。

## 与其他页面的关系

### 标准字段管理 vs 标准字段查看（CSV）

| 对比项 | 标准字段管理 | 标准字段查看（CSV） |
|--------|-------------|-------------------|
| 数据来源 | 数据库 | CSV文件（硬编码） |
| 是否可编辑 | 可能支持编辑 | 只读 |
| 用途 | 管理系统实际使用的标准字段 | 查看CSV定义的参考标准 |
| 字段数量 | 根据数据库实际数据 | 固定115个 |

### 甲方字段查看 vs 标准字段查看（CSV）

| 对比项 | 甲方字段查看 | 标准字段查看（CSV） |
|--------|------------|-------------------|
| 数据来源 | 甲方上传的JSON | CSV文件 |
| 字段内容 | 甲方实际字段 | 标准字段参考 |
| 用途 | 查看甲方字段配置 | 作为配置参考标准 |

## 最佳实践

### 1. 配置甲方字段前，先查看标准字段

在为新甲方配置字段映射前，建议先访问本页面，了解系统支持的标准字段有哪些。

### 2. 使用标准字段Key保持一致性

在甲方字段映射时，尽量使用标准字段的 `field_key`，保持数据结构的一致性。

### 3. 区分必填和可选字段

通过"拓展字段"列，可以快速识别哪些是核心必填字段（标准字段），哪些是可选的（拓展字段）。

### 4. 参考枚举值定义

对于Enum类型字段，参考CSV中定义的枚举值，保持数据规范统一。

## 更新日志

### v1.0.0 (2025-12-11)

**新增功能**：
- ✅ 创建标准字段CSV查看页面
- ✅ 支持按分组标签切换查看
- ✅ 支持搜索和筛选功能
- ✅ 显示字段完整信息（名称、类型、枚举值、示例、说明）
- ✅ 区分标准字段和拓展字段
- ✅ 支持分页浏览

**技术改进**：
- ✅ CSV数据转换为TypeScript格式
- ✅ 定义标准字段数据结构接口
- ✅ 实现分组树结构计算
- ✅ 添加路由配置和菜单项

## 后续计划

### Phase 2 功能规划

1. **导出功能**：支持将当前筛选的字段导出为Excel或CSV
2. **字段对比**：对比标准字段和甲方字段的差异
3. **字段统计**：统计各分组字段数量、类型分布等
4. **字段详情弹窗**：点击字段查看更详细的信息
5. **历史版本**：支持查看CSV文件的历史版本变更

### Phase 3 高级功能

1. **在线编辑CSV**：支持在界面中编辑标准字段定义
2. **字段依赖关系**：显示字段之间的依赖和引用关系
3. **字段使用情况**：统计各字段在系统中的实际使用率
4. **智能推荐**：根据甲方字段自动推荐对应的标准字段

## 反馈与支持

如有任何问题或建议，请联系：

- **开发团队**：大象
- **创建日期**：2025-12-11
- **文档版本**：v1.0.0


