# 通知模板错误修复说明

## 问题描述

在访问通知模板功能时遇到以下错误：

### 1. Element Plus Radio 组件警告
```
ElementPlusError: [el-radio] [API] label act as value is about to be deprecated in version 3.0.0, please use value instead.
```

### 2. 模块导入失败
```
TypeError: Failed to fetch dynamically imported module: 
http://localhost:5173/src/views/system/NotificationConfig.vue
```

## 已修复内容

### 1. ✅ 修复 Radio 组件

**问题**：Element Plus 3.0 即将废弃 `label` 属性作为值，需要使用 `value` 属性。

**修复位置**：`frontend/src/views/system/components/NotificationTemplateConfig.vue`

**修改前**：
```vue
<el-radio label="agency">机构</el-radio>
<el-radio label="team">小组</el-radio>
<el-radio label="collector">指定催员</el-radio>
```

**修改后**：
```vue
<el-radio value="agency">机构</el-radio>
<el-radio value="team">小组</el-radio>
<el-radio value="collector">指定催员</el-radio>
```

同样修复了优先级选择的 Radio 组件：
```vue
<el-radio value="high">高</el-radio>
<el-radio value="medium">中</el-radio>
<el-radio value="low">低</el-radio>
```

### 2. ✅ 修复 API 文件导入路径

**问题**：`notificationTemplate.ts` 文件中使用了错误的导入路径和请求方式。

**错误代码**：
```typescript
import request from './request'  // ❌ 错误：request 文件不存在
return request.get<NotificationTemplate[]>('/notification-templates', { params })  // ❌ 错误的调用方式
```

**修复后**：
```typescript
import request from '@/utils/request'  // ✅ 正确：从 utils 导入
return request<NotificationTemplate[]>({  // ✅ 正确的调用方式
  url: '/api/v1/notification-templates',
  method: 'get',
  params
})
```

所有 API 函数都已按照项目统一的方式修复。

### 3. ✅ 清理 Vite 缓存

**问题**：模块导入失败通常是由于 Vite 缓存导致的。

**解决方案**：已清理 `node_modules/.vite` 缓存目录。

## 解决步骤

如果你仍然遇到问题，请按以下步骤操作：

### 步骤 1：清理缓存
```bash
cd frontend
rm -rf node_modules/.vite
```

### 步骤 2：重启前端服务
```bash
# 如果前端服务正在运行，先停止它（Ctrl+C）
# 然后重新启动
npm run dev
```

### 步骤 3：强制刷新浏览器
在浏览器中按：
- **Mac**: `Cmd + Shift + R`
- **Windows/Linux**: `Ctrl + Shift + R`

### 步骤 4：清除浏览器缓存（如果仍有问题）
1. 打开浏览器开发者工具（F12）
2. 右键点击刷新按钮
3. 选择"清空缓存并硬性重新加载"

## 验证修复

访问以下页面验证修复是否成功：

1. 登录系统：`http://localhost:5173/admin/login`
2. 进入：系统管理 -> 通知配置 -> **通知模板**
3. 检查：
   - ✅ 页面正常加载
   - ✅ 没有 Radio 组件警告
   - ✅ 可以正常添加/编辑模板

## 其他已修复的类似问题

之前也修复了类似的 Element Plus 组件警告：

### el-link 组件
**文件**：
- `frontend/src/views/admin/Login.vue`
- `frontend/src/views/case-management/auto-assignment/StrategyList.vue`
- `frontend/src/components/CaseDetail.vue`

**修改**：
- `underline="false"` → `underline="never"` 或 `underline="hover"`

## 注意事项

1. **Element Plus 版本兼容性**
   - 当前使用的是 Element Plus 2.x
   - 部分 API 在 3.0 版本会被废弃
   - 我们已经按照 3.0 的要求进行了适配

2. **Vite 缓存问题**
   - 修改代码后如果没有生效，可能是缓存问题
   - 清理 `node_modules/.vite` 目录即可

3. **浏览器缓存**
   - 使用强制刷新（Cmd/Ctrl + Shift + R）
   - 或者清空浏览器缓存

## 相关文档

- [通知模板功能说明](./通知模板功能说明.md)
- [通知模板快速启动指南](./通知模板快速启动指南.md)
- [公共通知优化说明](./公共通知优化说明.md)

---

**修复时间**：2025-11-19  
**修复版本**：v1.0.1

